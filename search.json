[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "의학통계학",
    "section": "",
    "text": "Preface\n이 사이트는 2024년 의학통계학 강의를 위한 온라인 노트입니다.\n\n\n개요\n학부생을 위한 의학통계학 강의를 위하여 제공는 온라인 교과서입니다.\n\n\n\n\n\n\n주의\n\n\n\n이 강의노트는 지속적으로 업데이트될 예정입니다. 따라서 노트의 내용이 중간에 변경될 수도 있으니 주의하기 바랍니다.\n\n\n의학연구와 생명과학에 주로 사용되는 통계적 방법의 이론과 적용을 배우는 과목으로서 수강을 원하는 학생들은 기초통계학 또는 유사한 과목을 먼저 수강할 것을 추천합니다.\n이 교과서에서는 통계 방법들의 실습을 위하여 R 프로그램을 사용합니다. R 프로그램이 익숙하지 않는 학생들은 R 프로그램에 대한 기초적인 내용을 먼저 숙지하는 것을 추천합니다.\n이 교과서에서 사용한 일부 예제는 Jaewon Lee (2005) 와 Agresti (2003) 를 참조하였습니다.\n이 강의에서 사용하는 R 패키지는 다음과 같다.\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(epiR)\nlibrary(faraway)\n\n\n\n\nAgresti, Alan. 2003. Categorical data analysis. Vol 482. John Wiley & Sons.\n\n\nJaewon Lee, Hanna Yu, Mira Park. 2005. 생명과학연구를 위한 통계적 방법. 1st ed. 자유아카데미.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "notes/intro.html",
    "href": "notes/intro.html",
    "title": "1  서론",
    "section": "",
    "text": "1.1 공정한 실험\n20세기가 시작되면서 통계적 방법은 모든 과학분야의 연구에 적용되고 있습니다. 현대과학은 공정하고 합리적인 실험(또는 관측연구)에서 나오는 결론을 선호합니다. 이를 증거에 기반한 연구(evidence-based research)라고 합니다.\n증거에 기반한 연구를 수행하려면 공정한 실험을 수행할 수 있는 구체적인 방법을 결정해야 합니다. 또한 실험 대상자의 수와 자료를 분석하는 방법도 적절하게 정해야 합니다. 즉 실험을 계획하는 방법이 매우 중요합니다.\n그럼 공정하고 합리적인 실험은 어떤 것일까요? 이러한 질문에 대하여 실험을 수행할 때 발생할 수 있는 공정하지 않고 비합리적인 요소가 무었인지 찾아보면 답이 나오게 됩니다.\n이 과목을 수강할 떄 여러분은 이러한 질문을 수시로 던지면서 생각해 보기를 강력하게 추천합니다.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>서론</span>"
    ]
  },
  {
    "objectID": "notes/intro.html#의학연구의-특성",
    "href": "notes/intro.html#의학연구의-특성",
    "title": "1  서론",
    "section": "1.2 의학연구의 특성",
    "text": "1.2 의학연구의 특성\n사람을 대상으로 하는 의학연구, 즉 우리가 흔히 임살실험(clinical trial)이라고 부르는 실험들은 편향이 발생할 수 있는 여러 가지 요인를 제거하기 위하여 매우 정교하게 설계됩니다.\n사실 의학연구에서 통계학자의 가장 중요한 역활은 자료의 분석이 아니라 실험의 계획과 수행에 있습니다. 물론 다양한 방법을 사용하여 유용한 결론을 이끌어 내는 탐색적인 연구에서는 주어진 자료를 분석하는 능력도 매우 중요합니다. 하지만 치료법의 효과와 안전성을 확인하는 주요한 임상실험에서는 실험을 적절하고 효과적으로 계획하는 능력이 더 중요합니다.\n통상적으로 중요한 임상실험은 그 특성 상 연구을 시작하게 되면 최종 분석에 사용될 주요 변수를 바꿀수 없을 뿐만 아니라 실험의 방법과 대상자의 수도 원칙적으로 변경할 수 없습니다. 이렇게 실험을 수행할 때 강력한 제한을 두는 것은 실험에서 발생할 수 있는 여러가지 편향(bias)를 줄이기 위한 것입니다. 또한 유리한 실험만 선택하여 사용하거나 실험이 처리(treatment)외의 다른 요인에 의하여 영향을 받는 것을 차단하기 위해서입니다.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>서론</span>"
    ]
  },
  {
    "objectID": "notes/intro.html#통계적-주제",
    "href": "notes/intro.html#통계적-주제",
    "title": "1  서론",
    "section": "1.3 통계적 주제",
    "text": "1.3 통계적 주제\n예를 들어서 최근에 유행하고 있는 코로나 19에 대한 치료제의 효과와 안전성을 확인하는 임상실험을 상상해 봅시다. 이런 임상실험을 수행하기 위해서는 실험의 시작부터 종료까지 어떤 절차를 거쳐야 하며 긱 절차마다 수행해야할 작업은 무었을까요? 또한 실험이 종료되면 수집한 자료들은 어떻게 분석해야 할까요?\n임상실험을 계획하는 경우 통계학자의 입장에서 중요하게 고려해야할 사항은 다음과 같습니다.\n\n사용할 실험 방법은 무었인가?\n실험에 참가하는 환자들을 어떻게 치료 집단(treatment groups)에 배정해야 하는가?\n얼마나 많은 환자들이 실험에 참가해야 하는가?\n실험에서 수집되는 자료들은 어떤 특성을 가지는가?\n실험에서 수집된 자료를 어떤 방법을 적용하여 분석해야 하는가?",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>서론</span>"
    ]
  },
  {
    "objectID": "notes/intro.html#강의의-구성",
    "href": "notes/intro.html#강의의-구성",
    "title": "1  서론",
    "section": "1.4 강의의 구성",
    "text": "1.4 강의의 구성\n이 과목에서는 먼저 의학과 생명과학의 연구에서 수집된 자료를 분석할 수 있는 통계적 방법들은 배울 것입니다. 이러한 통계적 방법들은 주로 통계적 가설검정(statistical hypothesis tesing)과 선형모형(linear model) 또는 회귀모형(regression model)에 의거한 방법들입니다.\n두번째로 배우게 될 내용을 임상시험에서 사용되는 실험계획에 관련된 개념과 방법들입니다. 임의화(randomization)이 왜 실험에서 중요한 개념인지를 배울 것입니다. 유의수준과 검정력에 기반하여 실험 대상자의 수를 산정하는 법을 배울 것입니다. 또한 임상실험에서 사용되는 다양한 계획법에 대한여 배울것 입니다.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>서론</span>"
    ]
  },
  {
    "objectID": "notes/association.html",
    "href": "notes/association.html",
    "title": "2  연관성의 측도",
    "section": "",
    "text": "2.1 필요한 패키지\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(epiR)\nlibrary(faraway)",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>연관성의 측도</span>"
    ]
  },
  {
    "objectID": "notes/association.html#이항변수",
    "href": "notes/association.html#이항변수",
    "title": "2  연관성의 측도",
    "section": "2.2 이항변수",
    "text": "2.2 이항변수\n통계학에서 관측값은 값이 가지는 특성에 따라서 연속형 변수(continuous variable)과 범주형 변수(categorical variable)로 나눈다.\n결과가 2개인 범주형 변수인 이항변수(binary variable)는 매우 중요한 역할을 한다. 그 이유는 두 개의 선택 중에서 하나를 선택해 야할 의사결정이 실제로 대부분을 차지하고 있기 때문이다.\n예를 들어서 코로나 19에 감염된 환자가 병원에서 치료를 받고 있다고 가정해보자. 환자는 병원에서 여러 가지 검사를 수행하면서 다양한 자료를 수집한다. 예를 들어 환자는 수시로 체온을 재고 항체검사, 혈액검사 등을 받을 것이다. 다양한 검사 등에서 나온 자료는 연속형 또는 범주형 자료로 구성될 것이다.\n하지만 의사가 가장 중요하게 결정할 사항은 환자가 계속 치료를 필요로 하는지 아닌지 결정해야 한다. 즉, 여러 가지 검사를 고려하여 최종적으로 의사는 환자가 더 치료가 필요한지 아닌 지를 결정해야 한다. 의사의 결정을 이항변수 \\(Y\\)로 다음과 같이 표현할 수 있다..\n\\[\nY =\n\\begin{cases}\n1 & \\text{ if patient still needs treatment} \\\\\n0 & \\text{ if patient dose not need treatment any more (GO HOME!)}\n\\end{cases}\n\\]\n실제 임상에서는 이러한 두 개의 가능한 선택 중에 하나를 선택하는 결정이 빈번하게 일어나며 이러한 결정은 대부분 중요한 임상적 결정이다. 예를 들어 다음과 같은 의사결정들은 이항변수로 표현할 수 있다.\n\n환자는 약을 복용해야 하는가?\n환자는 입원을 해야 하는가?\n환자는 중환자실로 가야 하는가?\n환자는 퇴원해도 되는가?\n\n또는 환자의 상태(outcome)가 이항변수로 표현될 수 있다.\n\n환자는 치료가 되었는가?\n환자가 사망하였는가?\n\n이제 코로나 19 치료제의 효과를 알아보기 위한 임상실험을 수행하는 경우를 생각해보자. 통상적으로 임상실험에서는 두 개의 집단을 비교하며 가장 많이 사용하는 두 개의 집단은 실제 치료(drug)를 받은 사람들과 위약(placebo)을 받은 사람들이다. 즉 치료를 받은 사람과 받지 않는 사람들의 효과를 비교하는 것이 임상실험의 목적이다. 이러한 경우 앞에서 논의한 의사 결정과 마찬가지로 한 환자가 받은 치료의 종류를 이항변수 \\(X\\)로 나타낼 수 있다.\n\\[\nX=\n\\begin{cases}\n1 & \\text{ if patient receives drug} \\\\\n0 & \\text{ if treatment receives placebo}\n\\end{cases}\n\\]",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>연관성의 측도</span>"
    ]
  },
  {
    "objectID": "notes/association.html#분할표와-연관성의-측도",
    "href": "notes/association.html#분할표와-연관성의-측도",
    "title": "2  연관성의 측도",
    "section": "2.3 분할표와 연관성의 측도",
    "text": "2.3 분할표와 연관성의 측도\n\n2.3.1 분할표\n이제 앞에서 말한 두 개의 변수 \\(X\\) 와 \\(Y\\) 의 관계에 대해서 생각해 보자. 실험에서 사람들은 코로나 19에 대한 치료약의 효과에 관심이 있다. 코로나 19 환자가 치료약을 처치 받으면 치료약을 이용하지 않는 환자보다 빨리 치료되거나 사망할 가능성이 낮은 지가 주요 관심사이다. 즉, 치료약이 환자의 회복 속도나 사망과 연관(association)이 있는지 알고 싶은 것이며, 특히 실험이 매우 정교하게 설계된 경우는 치료약이 환자의 회복이나 사망에 영향을 미치는 원인이 되는지(cause-effect relation) 파악하고 싶은 것이다.\n\n먼저 코로나 19에 대한 치료약의 효과에 대한 임상실험에 \\(n\\) 명의 환자들이 실험에 참가 했다고 가정하자.\n치료약이 효과가 있는지에 대한 결과(\\(Y\\))는 치료를 시작하여 정해진 기간 내에 사망하였는지에 대한 사건으로 결정하였다.\n\n\\[\nY =\n\\begin{cases}\n1 & \\text{ if patient is dead within D days } \\\\\n0 & \\text{ otherwise}\n\\end{cases}\n\\]\n코로나 19에 대한 치료약의 효과에 대한 임상실험의 결과를 다음과 같은 분할표(contingency table)로 요약할 수 있다.\n\n\n\n표 2.1: \\(2 \\times 2\\) 분할표\n\n\n\n\n\n치료/결과\n사망 (\\(Y=1\\))\n생존 (\\(Y=0\\))\n합계\n\n\n\n\n위약 (\\(X=0\\))\n\\(n_{11}\\)\n\\(n_{12}\\)\n\\(n_{1+}\\)\n\n\n치료약 (\\(X=1\\))\n\\(n_{21}\\)\n\\(n_{22}\\)\n\\(n_{2+}\\)\n\n\n합계\n\\(n_{+1}\\)\n\\(n_{+2}\\)\n\\(n\\)\n\n\n\n\n\n\n많은 임상실험이나 의학연구의 결과들을 위와 같은 \\(2 \\times 2\\) 분할표로 요약할 수 있다. 이제 우리의 관심은 분할표를 통해서 임상실험의 결과를 어떻게 통계적으로 추론할 수 있는지이다.\n\n\n\n\n\n\n노트\n\n\n\n분할표에서 연관성의 측도를 계산하는 경우 성공의 기준(이항변수로 표현하면 \\(Y=1\\))에 따라서 계산을 수행해야 한다. 어떤 경우는 사망이나 악화와 같은 위험한 사건이 성공 사건이 될 수 있으며 어떤 경우는 생존이나 회복과 같은 좋은 사건이 성공이 될 수 있다.\n또한 기준이 되는 그룹(이항변수 \\(X\\))에 따라서 연관성의 측도 계산할 때 분자와 분모에 해당하는 그룹을 적절하게 선택해야 한다.\n분할표에서 연관성의 측도를 계산하는 경우 분석의 의도와 목적에 맞게 성공 사건과 기준그룹을 정의하고 그에 따라서 연관성의 측도를 계산해야 한다.\n\n\n\n\n2.3.2 상대위험\n\\(2 \\times 2\\) 분할표 2.1 에서 두 개의 처리군, 즉 치료약을 받은 집단과 위약을 받은 집단의 효과를 비교할 때 가장 많이 사용되는 측도(measure)는 상대위험(relative risk, risk ratio, prevalnce ratio;RR)이다.\n주어진 집단의 위험율을 그 집단에 속한 환자의 수에서 사망한 사람의 비율이다. 분할표 2.1 에서 위약 집단의 위험율은 \\(n_{11}/n_{1+}\\) 이며 이는 치료를 받지 않는 경우에 나타나는 기준점인 위험율(baseline risk)을 의미한다. 치료약 집단의 위험율은 \\(n_{21}/n_{2+}\\) 이다. 통상적으로 위험율은 비율(proportion, percent)로 나타내며 발생률(rate,예를 들어 인구 1000명당 X명)로 나타내기도 한다.\n상대위험은 두 위험율의 비율로서 다음과 같이 정의한다.\n\\[\\begin{equation}\nRR = \\frac{n_{11}/n_{1+}}{n_{21}/n_{2+}} = \\frac{ \\tfrac{n_{11}}{n_{11} + n_{12}}} { \\tfrac{n_{21}}{n_{21} + n_{22}}}\n\\end{equation}\\]\n상대위험이 1보다 크면 분자에 위치한 집단이 위험(위의 예제에서는 위험이 사망을 의미한다)에 처할 가능성이 분모에 위치한 집단보다 \\(RR\\) 배 높다는 것을 의미한다. 상대위험이 1이면 두 집단에 대한 위험이 동일하다는 것을 의미한다.\n예를 들어 특정한 코로나 치료제의 효과를 실험하는 임상실험에서 다음과 결과를 얻었다.\n\n\n\n표 2.2: 코로나 치료제 실험 결과\n\n\n\n\n\n치료/결과\n사망 (\\(Y=1\\))\n생존 (\\(Y=0\\))\n합계\n\n\n\n\n위약 (\\(X=0\\))\n\\(10\\)\n\\(1212\\)\n\\(1222\\)\n\n\n치료약 (\\(X=1\\))\n\\(5\\)\n\\(2355\\)\n\\(2360\\)\n\n\n합계\n\\(15\\)\n\\(3567\\)\n\\(3582\\)\n\n\n\n\n\n\n상대위험은 다음과 같이 계산된다.\n\\[ RR = \\frac{10/1222}{5/2360} = 3.8625 \\approx 4 \\]\n상대위험이 약 4 배란 의미는 치료약을 받은 집단보다 위약집단이 사망할 가능성이 약 4배 높다는 것이다.\n\n\n\n\n\n\n노트\n\n\n\n우리는 두 집단의 비율을 비교할 때 두 비율의 차이를 이용하는 방법을 자주 사용한다. 두 집단의 비율이 각각 \\(p_1\\), \\(p_2\\) 라면 두 비율의 차이는 \\(p_1 - p_2\\) 이며 이는 우리가 평상 적으로 사용하는 비율의 비교 측도이다.\n예를 들어 대통령 후보들의 지지율과 차이는 많은 언론에서 사용하고 있으며 기초 통계학에서 두 모집단의 비교를 위한 가설 검정에서도 비율의 차이를 이용하였다.\n위의 코로나 치료제의 효과를 비교하는 실험에서 치료집단과 위약집단의 사망률 차이를 측도로 사용하면 어떨까?\n\n\n\n\n2.3.3 기여위험과 백신효과\n기여위험(attributable proportion, attributable risk percent, AR)은 두 그룹의 위험에 대한 비교를 위한 다른 측도이다. 기여위험은 특정한 성격을 가진 집단(exposed group)이 위험에 처한 전체 집단에서 차지하는 비율을 백분율로 나타낸다.\n\\[\\begin{equation}\nAR = \\frac{ (n_{11}/n_{1+}) - (n_{21}/n_{2+})} {n_{11}/n_{1+} } \\times 100\n\\end{equation}\\]\n예를 들어 비흡연자(unexposed group)와 흡연자(exposed group)의 폐암에 대한 위험을 비교하는 경우를 생각해 보자.비흡연자의 폐암으로 인한 사망률이 연간 1000명 당 0.07명이고 흡연자는 1000명당 0.57명이라고 하면\n일단 상대위험은 약 8배이다.\n\\[  RR = 0.57/0.07 = 8.1428 \\]\n두 집단의 비교를 기여위험으로 나타내면 다음과 같다.\n\\[ AR = \\frac{0.57-0.07}{0.57} \\times (100) = 87.7\\% \\approx 88 \\%\\]\n만약 흡연이 폐암을 일으키는 원인이고 두 집단의 다른 요인이 유사하다고 가정하면, 기여위험이 약 88% 라는 것은 모든 폐암 환자(위험에 처한 전체 집단)의 88% 가 흡연에 의한 것이라고 해석할 수 있다.\n최근에 코로나 19에 대한 백신과 치료제의 임상실험에서 효과를 발표하는 경우 위에서 언급한 상대위험을 사용하지 않고 백신효과(Vaccine efficacy, vaccine effectiveness; VE) 라는 백분율을 사용한다. 백신효과는 기본적으로 기여위험과 동일한 측도이다.\n예를 들어 위의 예제에서 치료제의 효과를 백신효과(VE)로 계산하면 다음과 같다.\n\\[ VE = \\left [ \\frac{10/1222 - 5/2360}{10/1222} \\right ]\\times 100 =74.1101\\% \\]\n백신효과가 74% 란 의미는 치료제를 사용하면 사용하지 않는 경우보다 사망을 74% 줄일 수 있다고 해석할 수 있다.\n간단한 예로서 코로나19로 인한 치명율(사망자/확진자)을 비교한다고 가정하자. 백신을 맞은 그룹의 치명율이 1%이고 백신을 맞지 않는 그룹의 치명율이 2% 백신효과는 50%이다.\n\n\n2.3.4 오즈비\n오드(odd)는 가능성을 나타내는 측도로서 전통적으로 도박에서 유래된 측도이다.\n우리가 주사위를 던져서 1과 2가나오면 성공, 다른 숫자가 나오면 실패라고 하는 경우 성공의 확률은 \\(2/6 =0.3333\\) 으로 계산한다. 확률을 계산하는 경우는 분모에 전체 사건의 수를 사용한다.\n위의 주사위 예제로 오드를 계산하면 \\(2/4 =0.5\\) 가 된다. 즉, 오드는 분모에 성공을 제외한 실패의 사건을 수를 사용한다. 만약 오드가 1이면 무슨 의미인가? 오드가 1이면 성공하는 사건의 수가 실패하는 사건의 수가 동일하다는 의미이다. 게임에서 이길 확률이 \\(1/2\\) 이면 공정한 게임이며 이 경우 오드는 1 이다.\n전통적으로 오드는 확률의 개념이 나오기 전에 가능성의 측도로 오랫동안 사용되어 왔으며 도박에서 상대방이 1번 이길 때 내가 이기는 평균적인 횟수를 의미한다.\n\\[ odd = \\frac{\\text{number of events for success}}{\\text{number of events for failure}} \\]\n예를 들어 위의 코로나 치료제 실험에서 성공을 사망할 사건이라고 하면 위약군의 오드는 \\(n_{11}/n_{12} =10/1212\\) 이고 치료군의 오드는 \\(n_{21}/n_{22} = 5/2355\\) 이다.\n두 집단을 비교하는 측도 중 하나는 오즈비(odds ratio; OR)가 있다. 오즈비는 두 그룹의 오드들의 비율로 정의된다. 오즈비가 1이면 두 그룹에서 성공 사건의 가능성이 같다는 것이다.\n\\[ OR = \\frac{n_{11}/n_{12}}{n_{21}/n_{22}} = \\frac{n_{11} n_{22}}{n_{12} n_{21}} \\]\n코로나 치료제 실험에서의 오즈비는 \\((10/1212)/(5/2355) =3.8861\\) 이다.\n오즈비는 상대위험이나 기여위험에 비하여 의미 있는 해석이 어렵다. 오즈비가 1이면 두 집단이 성공의 가능성이 같다(또는 두 요인의 연관성이 없다)는 것으로 해석이 쉽다. 하지만 예를 들어 오즈비가 1 보다 큰 경우(또는 작은 경우) 두 집단의 차이를 의미 있게 해석하는 것이 어렵다.\n오즈비는 향후 학습할 통계적 가설검정에서 중요한 모수(parameter)로 사용되며 특히 실험의 방법이 사례-대조 연구와 같은 특별한 방법을 사용하는 경우 오즈비가 중요한 역할을 하게 된다.\n\n예를 들어 다음과 같은 분할표에서 비율의 차이, 상대위험, 오즈비를 구하여 비교해 보자.\n\n\n\n표 2.3: \\(2 \\times 2\\) 분할표 예제\n\n\n\n\n\n처리 /결과\n성공 (\\(Y=1\\))\n실패 (\\(Y=0\\))\n합계\n\n\n\n\n0 (\\(X=0\\))\n\\(6\\)\n\\(4\\)\n\\(10\\)\n\n\n1 (\\(X=1\\))\n\\(4\\)\n\\(6\\)\n\\(10\\)\n\n\n합계\n\\(10\\)\n\\(10\\)\n\\(20\\)\n\n\n\n\n\n\n비율의 차이(DP)은 다음과 같이 계산된다.\n\\[ DP(0/1) =  6/10 - 4/10 = 0.2 \\]\n상대위험은 다음과 같이 계산된다.\n\\[ RR(0/1) = \\frac{6/10}{4/10} = \\frac{6}{4} = 1.5 \\]\n오즈비는 다음과 같이 계산된다.\n\\[ OR(0/1) = \\frac{6/4}{4/6} = \\frac{(6)(6)}{(4)(4)} = 2.25 \\]",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>연관성의 측도</span>"
    ]
  },
  {
    "objectID": "notes/association.html#신뢰구간",
    "href": "notes/association.html#신뢰구간",
    "title": "2  연관성의 측도",
    "section": "2.4 신뢰구간",
    "text": "2.4 신뢰구간\n상대위험과 오즈비는 분할표에서 연관성을 나타내는 하나의 측도, 즉 점추정량(point estimation) 이다. 하나의 숫자로 표현되는 점추정은 표본으로 부터 발생한 불확실성을 반영하지 못한다. 따라서 점추정량을 보완하기 위하여 신뢰구간(confidence interval)을 제시할 수 있다.\n상대위험과 오즈비는 표본비율 또는 셀 도수의 함수로 나타난다. 하지만 함수의 형태가 비율로서 비선형이기 때문에 상대위험과 오즈비의 근사적인 표준오차(standard error)는 쉽게 구할 수 없다.\n다항분포를 가정하고 로그 오즈비의 점근적 분산을 다음과 같이 유도할 수 있다.\n\\[ v_1 =V ( \\log OR)   \\approx \\frac{1}{n_{11}} + \\frac{1}{n_{12}} + \\frac{1}{n_{21}} + \\frac{1}{n_{22}} \\]\n따라서 로그 오즈비의 \\(100(1-\\alpha)\\) % 근사 신뢰구간을 다음과 같이 구할 수 있다.\n\\[\\begin{equation*}\n   \\log OR \\pm z_{\\alpha/2} \\sqrt{v_1}\n\\end{equation*}\\]\n위의 신뢰구간을 오즈비로 역변환하면 오즈비 \\(OR\\) 의 \\(100(1-\\alpha)\\) % 근사 신뢰구간을 다음과 같다.\n\\[\n   ( OR \\times \\exp [ - z_{\\alpha/2} \\sqrt{v_1}], ~~OR \\times \\exp [  z_{\\alpha/2} \\sqrt{v_1}] )\n\\tag{2.1}\\]\n상대위험(RR)의 신뢰구간도 오즈비의 신뢰구간을 유도하는 방법과 유사하게 델타 방법을 사용하며 다음과 같이 구할 수 있다.\n\\[\n   ( RR \\times \\exp [ - z_{\\alpha/2} \\sqrt{v_2}], ~~OR \\times \\exp [  z_{\\alpha/2} \\sqrt{v_2}] )\n\\tag{2.2}\\]\n위의 식 2.2 에서 \\(v_2\\) 는 다음과 같이 계산한다.\n\\[ v_2 =V ( \\log RR)   \\approx \\frac{1-n_{11}/n_{1+}}{n_{11}} + \\frac{1-n_{21}/n_{2+}}{n_{21}} \\]\n\n2.4.1 예제: 아스피린 임상실험\n소량의 아스피린 복용이 심장병으로 인한 위험을 줄이는데 효과가 있는지 알아보고자 임상실험을 실시하였다. 22,701명의 남성을 임의화(randomization) 을 통해서 두 그룹으로 나눈 후, 한 그룹은 매일 일정량의 아스피린을 복용시키고 다른 그룹은 위약(palcebo)를 복용하게 한 후 약 5년간 심근경색이 일어나는지 알아보았다. 임상실험의 결과는 아래 표와 같다.\n\n\n\n표 2.4: 아스피린 임상실험 결과\n\n\n\n\n\n\n심근경색 발생\n심근경색 없음\n합\n\n\n\n\n아스피린\n\\(139\\)\n\\(10,898\\)\n\\(11,037\\)\n\n\n위약\n\\(239\\)\n\\(10,795\\)\n\\(11,034\\)\n\n\n\n\n\n\n위약 집단과 아스피린 집단의 상대위험은 다음과 같다.\n\\[ RR = \\frac{139/11037}{239/11034} = 0.581 \\]\n상대위험을 보면 1보다 작으므로 아스피린을 복용한 집단이 위약 집단에 비해서 심근 경색이 일어날 위험이 적어진 다는 것을 알 수 있다.\n상대위험의 95% 근사 신뢰구간은 다음과 같이 계산한다.\n먼저 다음 \\(v_2\\) 를 계산하면\n\\[ v_2 = \\frac{1-n_{11}/n_{1+}}{n_{11}} + \\frac{1-n_{21}/n_{2+}}{n_{21}}  =\n\\frac{1-139/11037}{139} + \\frac{1-239/11034}{239} = 0.011 \\]\n상대위험의 신뢰구간은 다음과 같다.\n\\[(0.581 \\times \\exp[-1.96\\sqrt{0.011}], 0.581 \\times \\exp[1.96\\sqrt{0.011}])\n= ( 0.473, 0.715)\\]\n위의 신뢰구간은 1을 포함하지 않으므로 상대위험이 1 과 유의한 차이가 있다고 할 수 있다. 결론적으로 아스피린의 복용은 심근경색의 발생을 감소시킨다고 할 수 있다.\n이제 epiR 패키지를 사용하여 위에서 분석한 내용을 다시 구해보자.\n먼저 위의 임상실험 자료를 R 의 matrix 형태로 저장한다.\n\nex1dat &lt;- matrix( c(139, 10898, 239, 10795), 2, 2, byrow=TRUE)\nex1dat\n\n     [,1]  [,2]\n[1,]  139 10898\n[2,]  239 10795\n\n\n이제 함수 epi.2by2를 이용하여 상대위험과 싱대구간을 구해보자. 임의화를 사용한 임상실험 자료인 경우 method = \"cross.sectional\" 으로 지정한다. 관심이 있는 사건(심근경색, outcome)의 도수가 첫 번째 열(column)에 있으니 outcome = \"as.columns\"이라고 지정한다.\n아래 결과에 Prevalence ratio라고 나오는 것이 상대위험이다.\n\nepi.2by2(dat = ex1dat, method = \"cross.sectional\", conf.level = 0.95, units = 100, \n   interpret = FALSE, outcome = \"as.columns\")\n\n             Outcome +    Outcome -      Total               Prev risk *\nExposed +          139        10898      11037       1.26 (1.06 to 1.49)\nExposed -          239        10795      11034       2.17 (1.90 to 2.46)\nTotal              378        21693      22071       1.71 (1.55 to 1.89)\n\nPoint estimates and 95% CIs:\n-------------------------------------------------------------------\nPrev risk ratio                                0.58 (0.47, 0.72)\nPrev odds ratio                                0.58 (0.47, 0.71)\nAttrib prev in the exposed *                   -0.91 (-1.25, -0.56)\nAttrib fraction in the exposed (%)            -71.99 (-111.63, -39.78)\nAttrib prev in the population *                -0.45 (-0.77, -0.13)\nAttrib fraction in the population (%)         -26.47 (-36.51, -17.18)\n-------------------------------------------------------------------\nUncorrected chi2 test that OR = 1: chi2(1) = 26.944 Pr&gt;chi2 = &lt;0.001\nFisher exact test that OR = 1: Pr&gt;chi2 = &lt;0.001\n Wald confidence limits\n CI: confidence interval\n * Outcomes per 100 population units",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>연관성의 측도</span>"
    ]
  },
  {
    "objectID": "notes/association.html#casecontrol",
    "href": "notes/association.html#casecontrol",
    "title": "2  연관성의 측도",
    "section": "2.5 사례-대조 연구",
    "text": "2.5 사례-대조 연구\n심장발작을 일으킨 환자와 그렇지 않은 사람들을 각각 214명씩 조사하여 과거에 약물남용을 한 경력이 있는지 조사한 사례-대조 연구의 자료이다.\n\n\n\n표 2.5: 약물 남용 사례-대조 연구 결과\n\n\n\n\n\n\n심장 발작 발생\n심장발작 없음\n\n\n\n\n약물남용 유\n\\(73\\)\n\\(18\\)\n\n\n약물남용 무\n\\(141\\)\n\\(196\\)\n\n\n합\n214\n214\n\n\n\n\n\n\n이 연구의 목표는 약물남용과 심장발작의 연관성이 있는지를 알아보는 것이다. 이제 다음과 같은 사건들을 정의해 보자.\n\n\\(H+\\): 심장발작이 발생했다.\n\\(H-\\): 심장발작이 발생하지 않았다.\n\\(D+\\): 약물남용을 했다.\n\\(D-\\): 약물남용을 하지 않았다.\n\n위에서 정의된 사건들을 고려할 때 사례-대조 연구의 자료에서 다음과 같은 조건부 확률에 대한 추정값을 구할 수 있다.\n\\[\\begin{align*}\nP(\\textrm{약물남용을 했다} | \\textrm{심장발작이 발생했다}) & =P(D+|H+) = \\frac{73}{214} \\\\\nP(\\textrm{약물남용을 하지 않았다} | \\textrm{심장발작이 발생했다}) & =P(D-|H+) = 1- P(D+|H+) = \\frac{141}{214} \\\\\n  & \\\\\nP(\\textrm{약물남용을 했다} | \\textrm{심장발작이 발생하지 않았다}) & =P(D+|H-) = \\frac{18}{214} \\\\\n  P(\\textrm{약물남용을 하지 않았다} | \\textrm{심장발작이 발생하지 않았다}) & =P(D-|H-) = 1- P(D+|H-) = \\frac{196}{214}\n\\end{align*}\\]\n\n2.5.1 사례대조 연구의 목표와 가설\n연구에서 비교하고 싶은 비율은 위에서 추정한 확률이 아니고 조건과 결과가 바뀐 다음과 같은 조건부 확률이다. \\[\\begin{align*}\nP( \\textrm{심장발작이 발생했다} | \\textrm{약물남용을 했다} ) & = P(H+|D+) \\\\\nP( \\textrm{심장발작이 발생했다} | \\textrm{약물남용을 하지 않았다} ) & = P(H+|D-) \\\\\n\\end{align*}\\]\n즉 연구의 목표는 다음과 같은 가설을 검정하는 것이다.\n\\[\nH_0: P(H+|D+) = P(H+|D-)  ~~~\\text{ vs } ~~~H_1: P(H+|D+) \\ne P(H+|D-)\n\\tag{2.3}\\]\n전체 모집단을 약물남용을 한 사람들과 하지 않은 사람들로 두 집단으로 나누었을 때 두 집단에 대한 심장발작의 확률이 같은지 다른지 비교하고 싶은 것이다.\n위의 식에서 보듯이 추정하고 싶은 확률인 \\(P(H+|D+)\\)와 \\(P(H+|D-)\\)를 추정하려면 전체 모집단에 대한 심장발작 발병률 \\(P(H+)\\)와 약물남용의 비율 \\(P(D+)\\)를 알아야 한다. 즉\n\\[\\begin{align*}\nP(H+|D+) & = \\frac{ P(H+ \\cap D+)} { P(D+)} \\\\\n          & = \\frac{ P(D+|H+) P(H+)} { P(D+)} \\\\\n          & \\approx  (73/214) \\frac{ P(H+)} { P(D+)} \\\\\n\\end{align*}\\]\n위의 식은 다음의 조건부 확률 공식을 각 단계마다 적용한 결과이다.\n\\[ P(A \\cap B) = P(A|B)P(B) = P(B|A) P(A) \\]\n사례-대조 연구의 자료만으로는 모집단에 대한 심장발작 발병률 \\(P(H+)\\)와 약물남용의 비율 \\(P(D+)\\)을 구할 수 없다. 또한 다른 외부의 자료가 있다 하더라도 약물남용의 비율을 정확하게 추정하는 것은 매우 어렵다.\n\n\n2.5.2 오즈비의 비교\n이러한 문제는 두 집단의 비율의 차이나 상대위험을 비교하지 않고 오즈비를 구하여 비교하면 심장발작 발병률와 약물남용의 비율을 추정하지 않고 사례-대조 연구의 자료만으로 추론이 가능하다.\n다음의 가설은 두 비율의 비교를 오즈비로 표현한 것이다.\n\\[\nH_0: \\frac{P(H+|D+)/P(H-|D+)}{P(H+|D-) / P(H-|D-)} =1  ~~~\\text{ vs } ~~~H_1:\n\\frac{P(H+|D+)/P(H-|D+)}{P(H+|D-) / P(H-|D-)} \\ne 1\n\\tag{2.4}\\]\n위의 가설 2.4 는 단순한 비율을 비교하는 가설 2.3 과 동일한 가설이다.\n가설 2.4 에서 나타는 오즈비는 심장발작 발병률와 약물남용의 비율을 이용하지 않고 사례-대조 연구에서 추정할 수 있는 조건부 확률만으로 추정할 수 있다.\n\\[\\begin{align*}\n\\frac{P(H+|D+)/P(H-|D+)}{P(H+|D-) / P(H-|D-)}  \n   & =  \\frac{[P(H+|D+)P(D+)]/[P(H-|D+)P(D+)]}{[P(H+|D-)P(D-)] / [P(H-|D-)P(D-)]} \\\\\n   & =  \\frac{P(H+ \\cap D+)/P(H- \\cap D+)}{P(H+ \\cap D-) / P(H- \\cap D-)}\\\\\n   & =  \\frac{[P(D+|H+)P(H+)]/ [P(D+|H-) P(H-)]} {[P( D-|H+)P(H+)] / [P(D-|H-)P(H-)]}\\\\\n   & =  \\frac{P(D+|H+)/ P(D+|H-)} {P( D-|H+) / P(D-|H-)} \\\\\n   &=   \\frac{(73/214)/ (142/214)} {(18/214)/ (196/214)} \\\\\n   & = \\frac{(73)(196)}{(141)(18)} \\\\\n   & = 5.64\n\\end{align*}\\]\n결론적으로 사례-대조 연구에서는 연구의 목표에 대한 가설 검정을 비율의 차이나 상대위험으로 표현하여 수행할 수 없다. 하지만 오즈비를 검정하는 것으로 가설을 세우면 자료에서 쉽게 유도할 수 있는 오즈비로 가설 검정을 쉽게 수행할 수 있다.\n\n\n2.5.3 예제: 약물남용 사례-대조 연구\n심작발작을 일으킨 환자와 그렇지 않은 사람들을 각각 214명씩 조사하여 과거에 약물남용을 한 경력이 있느지 조사한 사례-대조 연구(case-control study) 의 결과가 표 2.5 에 있다.\n사례-대조 연구는 사례(case)가 발견되면, 즉 위의 연구와 같이 심장발작이 일어난 환자가 발생하면 그 환자와 유사한 나이와 성별 등을 가진 일반사람을 찾아 매칭하여 환자와 일반인의 과거 경력을 조사하는 후향적인 연구(restrspective study)이다. 반대로 앞의 예제에서 본 임의화를 이용한 임상실험은 전향적 연구(prospective study)이다.\n이러한 사례-대조 연구에서는 상대위험을 이용하여 연관성을 알아낼 수 없다. 하지만 사례-대조 연구에서 상대위험 대신 오즈비를 이용하여 연관성을 추론할 수 있다.\n위의 심장발작에 대한 사례-대조 연구의 결과에서 오즈비와 그 신뢰구간을 구해보자.\n먼저 오즈비는 다음과 같다.\n\\[ OR = \\frac{(73)(196)}{(18)(141)} = 5.64 \\]\n위의 결과는 심장발작이 일어난 집단에서 약물남용을 한 환자들의 오즈가 심장발작이 일어나지 않은 집단에서 약물남용을 한 사람들의 오즈에 비해 5.6배 크다는 것을 알 수 있으며 이는 1보다 상당히 크다.\n오즈비의 95% 근사 신뢰구간은 다음과 같이 계산한다.\n먼저 다음 \\(v_1\\) 를 계산하면\n\\[ v_1 =V ( \\log OR)   \\approx \\frac{1}{n_{11}} + \\frac{1}{n_{12}} + \\frac{1}{n_{21}} + \\frac{1}{n_{22}} = \\frac{1}{73} + \\frac{1}{18} + \\frac{1}{141} + \\frac{1}{196} =0.08\\]\n오즈비의 신뢰구간은 다음과 같다.\n\\[(5.64 \\times \\exp[-1.96\\sqrt{0.08}], 5.64 \\times \\exp[1.96\\sqrt{0.08}])\n= (3.222, 9.863)\\]\n위의 신뢰구간을 보면 1을 포함하지 않으므로 약물남용이 심장발작의 위험을 높인다고 말할 수 있다.\n이제 epiR 패키지를 사용하여 위에서 분석한 내용을 다시 구해보자.\n먼저 위의 사례-대조 연구 자료를 R 의 matrix 형태로 저장한다.\n\nex2dat &lt;- matrix( c(73,18,141,196), 2, 2, byrow=TRUE)\nex2dat\n\n     [,1] [,2]\n[1,]   73   18\n[2,]  141  196\n\n\n이제 함수 epi.2by2를 이용하여 오즈비과 신뢰구간을 구해보자. 사례-대조 연구의 자료인 경우 method = \"case.control\" 으로 저장한다. 사례-대조 연구로 지정하면 상대위험이 출력되지 않는다. 관심이 있는 사건(심장발작, outcome)의 도수가 첫 번째 열(column)에 있으니 outcome = \"as.columns\"이라고 지정한다.\n\nepi.2by2(dat = ex2dat, method = \"case.control\", conf.level = 0.95, units = 100, \n   interpret = FALSE, outcome = \"as.columns\")\n\n             Outcome +    Outcome -      Total                       Odds\nExposed +           73           18         91        4.06 (2.50 to 7.27)\nExposed -          141          196        337        0.72 (0.57 to 0.89)\nTotal              214          214        428        1.00 (0.83 to 1.21)\n\nPoint estimates and 95% CIs:\n-------------------------------------------------------------------\nExposure odds ratio                            5.64 (3.22, 9.86)\nAttrib fraction (est) in the exposed (%)      82.19 (68.26, 90.44)\nAttrib fraction (est) in the population (%)   28.06 (20.13, 35.21)\n-------------------------------------------------------------------\nUncorrected chi2 test that OR = 1: chi2(1) = 42.218 Pr&gt;chi2 = &lt;0.001\nFisher exact test that OR = 1: Pr&gt;chi2 = &lt;0.001\n Wald confidence limits\n CI: confidence interval",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>연관성의 측도</span>"
    ]
  },
  {
    "objectID": "notes/association-test.html",
    "href": "notes/association-test.html",
    "title": "3  연관성의 검정",
    "section": "",
    "text": "3.1 필요한 패키지\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(epiR)\nlibrary(faraway)",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>연관성의 검정</span>"
    ]
  },
  {
    "objectID": "notes/association-test.html#카이제곱-검정",
    "href": "notes/association-test.html#카이제곱-검정",
    "title": "3  연관성의 검정",
    "section": "3.2 카이제곱 검정",
    "text": "3.2 카이제곱 검정\n일단 2개의 이항변수 \\(X\\) 와 \\(Y\\) 를 고려하고 가능한 결과의 조합과 그 확률은 다음과 같은 \\(2 \\times 2\\) 분할표로 나타낼 수 있다.\n\n\n\n그림 3.1: 2 x 2 분할표\n\n\n\n\n\n\n일반적으로 \\(2 \\times 2\\) 분할표에서 다음과 같은 두 가지 가설이 가능하다.\n\n동질성 검정(homogeneuty test)\n변수 \\(X\\) 가 단순하게 독립 집단을 나누는 변수인 경우 (예를 들어 실험약 집단과 위약 집단) 두 그룹 간에 이항변수 \\(Y\\)의 성공확률이 같은지 검정하는 경우이다. 실험약 집단과 위약 집단에서 심장병이 발병할 확률이 같은지 검정을 수행할 때 귀무가설은 다음과 같다.\n\n\\[ H_0: p_{1j} = p_{2j} = p_j \\]\n\n독립성 검정(independent test)\n변수 \\(X\\) 와 \\(Y\\) 가 모두 확률변수인 경우 두 변수가 독립인지 검정하는 경우이다. 예를 들어 흡연(\\(X\\))과 심근경색(\\(Y\\))의 관계를 연구하는 경우 두 사건이 모두 확률적인 사건이라고 보고 다음과 같이 독립에 대한 가설을 고려한다.\n\n\\[ H_0: p_{ij} = p_{i+} p_{+j} \\]\n다음과 같이 \\(n\\) 개의 관측값으로 구성된 \\(2 \\times 2\\) 분할표에서 동질성과 독립성 가설을 검정하는 방법은 동일하며 따라서 굳이 두 가지 가설을 엄격하게 구별할 이유는 없다. 만약 귀무가설이 기각되면 두 변수의 연과성은 유의하다고 결론을 내린다.\n\n\n\n그림 3.2: 2 x 2 분할표: 관측 도수\n\n\n\n\n\n\n동질성과 독립성에 대한 검정은 다음과 같은 카이제곱 통계량을 사용한다.\n\\[\n\\chi^2 = \\sum_{i=1}^2 \\sum_{j=1}^2 \\frac{(O_{ij} - E_{ij})^2}{E_ij}  \n\\tag{3.1}\\]\n위의 카이제곱 통계량에서 \\(O_{ij} = n_{ij}\\) 는 각 셀의 관측도수이며 \\(E_{ij}\\)는 귀무가설 하에서의 셀 도수의 예측값이다.\n동질성 검정을 고려할 때 만약 귀무가설이 참이라면 확률 \\(p_{1j} =p_{2j}=p_j\\) 는 다음과 같이 추정할 수 있다.\n\\[ \\hat p_{j} = \\frac{n_{+j}}{n} \\]\n따라서 셀 \\((i,j)\\) 에 대한 기데 돗수 \\(E_{ij}\\) 는 다음과 같이 계산된다.\n\\[\nE_{ij} =n_{i+} \\hat p_j =\\frac{n_{i+} n_{+j}}{n}\n\\tag{3.2}\\]\n귀무가설 하에서 표본의 크기가 충분히 크면 식 3.1 의 카이제곱 검정통계량 \\(\\chi^2\\) 는 자유도가 1인 카이제곱 분포를 따른다. 그러므로 이 사실을 이용하여 p-값을 계산하거나 기각역을 구하여 검정한다.\n일반적인 \\(I \\times J\\) 분할표도 동일한 방법으로 가설검정을 할 수 있다. 카이제곱 통계량을 구하는 방법은 \\(2 \\times 2\\) 분할표와 유사하다. 다만 귀무가설이 참인 경우 검정통계량은 자유도가 \\((I-1)(J-1)\\) 인 카이제곱 분포를 따른다.\n\\[\n\\chi^2 = \\sum_{i=1}^I \\sum_{j=1}^J \\frac{(O_{ij} - E_{ij})^2}{E_ij}  \n\\]\n이제 실제 분할표에서 카이제곱 검정을 수행해 보자. 아스피린 임상실험 결과가 주어진 표 2.4 에서 아스피린의 횩과사 없는 경우, 즉 귀무가설이 참인 경우 다음과 같이 심근경색의 유무에 대한 예측 확률을 구할 수 있다.\n\\[ \\hat p_1 = \\frac{n_{+1}}{n} = \\frac{139+239}{22071} = 0.0171 \\] \\[\\hat p_2 = \\frac{n_{+2}}{n} = \\frac{10898+10795}{22071} = 0.9829 \\]\n이제 각 셀의 기대도수를 식 3.2 에 의하여 계산할 수 있다. 예를 들어 \\(E_{11}\\) 은 다음과 같이 계산된다.\n\\[ E_{11} = \\frac{n_{1+}n_{+1}}{n} =  n_{1+} \\hat p_1 = (11037)(0.0171) = 189.03 \\]\n각 셀에 대한 기대도수 \\(E_{ij}\\) 를 구하고 식 3.1 의 카이제곱 통계량을 구하면 다음과 같다.\n\\[\\begin{align*}\n\\chi^2 & = \\frac{(139-189.03)^2}{189.03} +  \\frac{(10898-10848.00)^2}{10848.00}  \\\\\n& \\quad + \\frac{(239-188.97)^2}{188.97} +  \\frac{(10795-10845.03)^2}{10845.03}  \\\\\n& = 26.94\n\\end{align*}\\]\n자유도가 1인 카이제곱 분포의 상위 5% 백분위수 \\(3.84\\) 이다. 위에서 구한 카이제곱 통계량의 값이 \\(26.94\\) 로서 \\(3.84\\) 보다 크므로 귀무가설을 기각한다. 즉 아스프린과 위약을 복용한 두 그룹 사이에는 심근경색이 일어날 비율에 유의한 차이가 있다.\nR 에서도 카이제곱 검정을 쉽게 수행할 수 있다. 앞에서 표 2.4 의 자료를 행렬의 형태로 저장하였는데 함수 chisq.test() 를 사용하면 결과를 쉽게 구할 수 있다.\n\nex1dat &lt;- matrix( c(139, 10898, 239, 10795), 2, 2, byrow=TRUE)\nex1dat\n\n     [,1]  [,2]\n[1,]  139 10898\n[2,]  239 10795\n\n\n\nchisq.test(ex1dat)\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  ex1dat\nX-squared = 26.408, df = 1, p-value = 2.764e-07\n\n\n분할표에서의 기대도수 \\(E_{ij}\\) 는 다음과 같이 얻을 수 있다.\n\nchisq.test(ex1dat)$expected\n\n         [,1]     [,2]\n[1,] 189.0257 10847.97\n[2,] 188.9743 10845.03",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>연관성의 검정</span>"
    ]
  },
  {
    "objectID": "notes/association-test.html#코크란-맨텔-헨젤-검정",
    "href": "notes/association-test.html#코크란-맨텔-헨젤-검정",
    "title": "3  연관성의 검정",
    "section": "3.3 코크란-맨텔-헨젤 검정",
    "text": "3.3 코크란-맨텔-헨젤 검정\n임상실험이나 의학연구는 여러 나라 또는 여러 병원들에서 진행되는 경우가 있다. 이러한 경우 국가나 병원의 고유한 특성에 따라서 실험의 결과가 다르게 나타날 수 있다. 이렇게 그룹에 의한 효과를 그룹 효과 또는 층(strata)에 의한 효과라고 한다. 예를 들어 진통제에 대한 효과는 그 나라의 문화나 관습에 따라서 효과의 차이가 나타날 수 있다. 또한 여러 개의 변원에서 연그ㅜ가 동시에 진행된다면 병원의 규모, 위치, 환자들의 특성에 따라서 치료 효과의 차이가 나타날 수 있다.\n이렇게 그룹에 따른 차이가 예상되는 경우 그룹의 효과를 제어하면서 처리 효과의 차이를 검정하는 방법이 필요하다. 이렇게 여러 개의 층으로 구성된 독립집단에서 얻은 자료에서 층에 의한 횩과를 통제하면서 동질성 또는 독립성 검정을 수행하는 방법을 코크란-맨텔-헨젤 검정 (Cochran-Mantel-Haenzel test)라고 한다.\n아래와 같이 \\(K\\) 개의 독립집단(또는 층)에서 각각 얻은 \\(K\\) 개의 \\(2 \\times2\\) 분할표가 있다고 하자.\n\n\n\n그림 3.3: K 개의 2 x 2 분할표\n\n\n\n\n\n\n\\(K\\) 개의 독립집단이 있고 성공의 확률이 \\(p_1\\), 실패의 학률이 \\(p_2\\) 라고 한다면 처리의 효과를 전체적으로 비교하는 가설은 다음과 같다.\n\\[ H_0: p_1 =p_2 \\quad \\text{sv.} \\quad H_1: p_1 \\ne p_2 \\]\n이제 귀무가설의 가정 하에서 각 분할표에서 \\(n_{k11}\\) 에 대한 기대도수 \\(\\mu_{k11}\\) 와 그 분산 \\(v_{k11}\\) 을 다음과 같이 계산한다.\n\\[\n\\mu_{k11} = E(n_{k11} | H_0) = \\frac{ n_{k1+} n_{k+1} }{ n_k}\n\\]\n\\[\nv_{k11} = V ( n_{k11} | H_0)  = \\frac{ n_{k1+} n_{k2+} n_{k+1} n_{k+2} }{n^2_k (n_k-1)}\n\\]\n이제 가설검정을 위한 통계량 \\(Q_{CMH}\\) 은 다음과 같다.\n\\[\nQ_{CMH} = \\frac{ \\left [  \\sum_{k=1}^K  (n_{k11} - \\mu_{k11}) \\right ]^2 }{\\sum_{k=1}^K v_{k11}}\n\\tag{3.3}\\]\n귀무가설이 참인 경우 검정통계량 \\(Q_{CMH}\\) 은 자유도가 \\(1\\) 인 카이제곱 분포를 따른다.\n이제 Agresti (2012) 의 6.3절에 있는 다기관 임상시험(multi-center clinical trial) 의 예제를 살펴보자. 아래 표는 모두 8개의 독립적인 병원에서 감염 치료제에 대한 효과에 대한 실험을 실시하여 얻은 자료이다.\n\n\n\n그림 3.4: 8개 병원의 임상실험 결과\n\n\n\n\n\n\n마지막 병원을 제외한 7개의 병원에서 치료제의 효과가 긍정적으로 나타났다. 여기서 주목할 점은 병원에 따라서 연관성의 강도가 매우 다르게 나타날 수 있다는 것이다.\n이제 각 병원을 층(strata)로 고려하고 병원의 효과를 제어하면서 식 3.3 의 검정 통계량 \\(Q_{CMH}\\) 를 이용하여 치료제의 효과가 있는지 검정해보자. 검정은 아래와 같이 R 프로그램을 이용한다. 함수 mantelhaen.test() 는 코크란-맨텔-헨젤 검정을 수행하는 함수이다.\n\nbeitler &lt;- c(11,10,25,27,16,22,4,10,14,7,5,12,2,1,14,16,6,0,11,12,1,0,10,10,1,1,4,8,4,6,2,1)\nbeitler &lt;- array(beitler, dim=c(2,2,8))\nbeitler\n\n, , 1\n\n     [,1] [,2]\n[1,]   11   25\n[2,]   10   27\n\n, , 2\n\n     [,1] [,2]\n[1,]   16    4\n[2,]   22   10\n\n, , 3\n\n     [,1] [,2]\n[1,]   14    5\n[2,]    7   12\n\n, , 4\n\n     [,1] [,2]\n[1,]    2   14\n[2,]    1   16\n\n, , 5\n\n     [,1] [,2]\n[1,]    6   11\n[2,]    0   12\n\n, , 6\n\n     [,1] [,2]\n[1,]    1   10\n[2,]    0   10\n\n, , 7\n\n     [,1] [,2]\n[1,]    1    4\n[2,]    1    8\n\n, , 8\n\n     [,1] [,2]\n[1,]    4    2\n[2,]    6    1\n\nmantelhaen.test(beitler, correct=FALSE)\n\n\n    Mantel-Haenszel chi-squared test without continuity correction\n\ndata:  beitler\nMantel-Haenszel X-squared = 6.3841, df = 1, p-value = 0.01151\nalternative hypothesis: true common odds ratio is not equal to 1\n95 percent confidence interval:\n 1.177590 3.869174\nsample estimates:\ncommon odds ratio \n         2.134549 \n\n\n검정 통계량 \\(Q_{CMH}\\)의 값이 \\(6.3841\\) 이고 p-값은 \\(0.0115\\) 이므로 귀무가설을 기각한다.",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>연관성의 검정</span>"
    ]
  },
  {
    "objectID": "notes/association-test.html#맥나마-검정",
    "href": "notes/association-test.html#맥나마-검정",
    "title": "3  연관성의 검정",
    "section": "3.4 맥나마 검정",
    "text": "3.4 맥나마 검정\n연속형 변수에서 짝지은 자료를 비교할 때 사용하는 방법이 대응 t-검정(paired t-test) 또는 짝표본 t-검정이다. 예를 들어 천식환자가 A약을 먹고 폐활량을 측정하고 일정 기간이 지나서 같은 환자가 B약을 먹고 폐활량을 측정하면 두 관측값은 독립이 아나다. 따라서 이러한 경우 독립 t-검정이 아닌 대응 t-검정을 시용한다.\n이제 이산형 변수가 짝으로 나타나는 경우를 생각해보자. 예를 들어 눈병 치료에 사용되는 A약과 B약의 효과를비교하기 위하여 각각의 약을 환자의 오른쪽 눈과 왼쪽 눈에 처치를 하고 치료의 여부를 관측하였다고 하자.\n\n\n\n그림 3.5: 짝표본 실험에 의한 2 x 2 분할표\n\n\n\n\n\n\n위의 표에서 \\(n_{11}\\) 은 A약과 B약의 효과가 모두 나타난 환자의 도수이다. \\(n_{12}\\) 은 A약은 효과가 있고 B약은 효과가 없는 환자의 도수이다. 이러한 자료는 앞에서 배운 카이제곱 검정을 적용할 수 없다.\n이제 일반적으로 짝표본에서 나온 자료가 다음 표와 같이 얻어졌다고 가정하자.\n\n\n\n그림 3.6: 짝표본 실험에 의한 2 x 2 분할표\n\n\n\n\n\n\n이제 조건 1 에서 성공의 확률을 \\(p_1\\) 이라고 하고 조건 2에서 성공의 확률을 \\(p_2\\) 라고 하면 짝표본에서 얻어진 분할표 그림 3.6 에서 관심있는 가설은 다음과 같다.\n\\[ H_0: p_1 =p_2 \\quad \\text{sv.} \\quad H_1: p_1 \\ne p_2 \\]\n분할표 그림 3.6 에서 \\(p_1\\) 과 \\(p_2\\)의 추정량은 다음과 같다.\n\\[ \\hat p_1 = \\frac{n_{1+}}{n}, \\quad \\hat p_2 = \\frac{n_{+1}}{n} \\]\n\\(p_1\\) 과 \\(p_2\\)의 추정량의 차이는 두 조건에 따른 결과가 일치하지 않는 도수 \\(n_{12}\\)와 \\(n_{21}\\)의 차이에 의존한다.\n\\[ \\hat p_1 -\\hat p_2 = \\frac{n_{1+}}{n} - \\frac{n_{+1}}{n} =\n\\frac{n_{11} + n_{12}}{n} - \\frac{n_{11} + n_{21}}{n} = \\frac{n_{12} - n_{21}}{n}\n\\]\n맥나마 검정(McNemar Test)는 도수 \\(n_{12}\\)와 \\(n_{21}\\)에 의거하여 두 확률이 같은지 검정하는 방법을 제시하였다. 맥나마 검정을 위한 통계량은 다음과 같다.\n\\[\nQ_{M} = \\frac{ (n_{12}-n_{21})^2}{n_{12} + n_{21}}\n\\tag{3.4}\\]\n맥나마 검정 통계량 \\(Q_{M}\\)은 귀무가설 하에서 근사적으로 자유도가 1인 카이제곱 분포를 따른다.\n다음은 1600명 영국 시민들의 수상에 대한 지지 여부를 두 개의 연속된 여론 조사에서 수집한 자료이다 (Agresti 2012 의 10장 참조). 이제 두 시점에서 수상에 대한 지지율이 같은지 아닌지 R 을 이용하여 맥나마 검정을 해보자. 맥나마 검정은 함수 mcnemar.test()를 사용하여 수행할 수 있다.\n\n\n\n그림 3.7: 영국시민의 수상에 대한 지지도 조사 자료\n\n\n\n\n\n\n\nex3dat &lt;- matrix(c(794,150,86,570),byrow=T,ncol=2)\nex3dat\n\n     [,1] [,2]\n[1,]  794  150\n[2,]   86  570\n\nmcnemar.test(ex3dat ,correct=F)\n\n\n    McNemar's Chi-squared test\n\ndata:  ex3dat\nMcNemar's chi-squared = 17.356, df = 1, p-value = 3.099e-05\n\n\n검정의 p-값이 매우 작으므로 귀무가설을 기각한다. 두 시점에서 수상에 대한 지지율이 하락했다고 할 수 있다. 참고로 첫 번째 조사에서의 지지율의 추정치는 \\(\\hat p_1=944/1600= 0.59\\) 이고 두 번째 조사에서의 지지율의 추정치는 \\(\\hat p_2=880/1600= 0.55\\) 이다. 또한 의견을 바꾸지 않은 사람의 비율은 \\((794+570)/1600=0.8225\\)로 대부분의 시민들이 지지 의견을 바꾸지 않았다.\n\n\n\n\nAgresti, Alan. 2012. Categorical data analysis. Vol 792. John Wiley & Sons.",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>연관성의 검정</span>"
    ]
  },
  {
    "objectID": "notes/diagnose.html",
    "href": "notes/diagnose.html",
    "title": "4  진단의 평가",
    "section": "",
    "text": "4.1 민감도와 특이도\n진단 기법을 평가하는 경우 다음과 같은 두 질문에 대해서 생각해 보아야 한다.\n양성인 사람을 얼마나 잘 양성으로 판단하는지에 대한 평가 기준이 민감도(sensitivity) 이고 음성인 사람을 얼마나 잘 음성으로 판단하는지에 대한 평가 기준이 특이도(specificity) 이다. 민감도와 특이도의 정도는 확률로서 나타낼 수 있다.\n진단 기법에 대한 실험 연구를 수행하면 그 결과는 \\(2 \\times 2\\) 분할표로 다음과 같이 요약할 수 있다. 일반적으로 진단 기법의 효과를 측정하는 실험은 대상자에 대한 질병의 유무를 알고 시작한다.\n위의 표에서 각 셀에 해당하는 진단 결과는 다음과 같이 나타낼 수 있다.\n이제 분할표 4.1 에서 민감도와 특이도는 다음과 같이 정의된다.\n\\[\\begin{align}\n\\text{Sensitivity}(민감도) & = \\frac{TP}{TP+FN} \\\\\n\\text{Specificity}(특이도) & = \\frac{TN}{FP+TN}\n\\end{align}\\]\n다음은 코로나 바이러스 검사법에 대한 여러 연구에서 나온 민감도와 특이도 결과를 보여 준다 (Butler-Laporte 기타 (2021)).\n예제로서 그림 그림 4.1 에 제시한 종합적인 결과(pooled counts)를 이용하여 민감도와 특이도를 구해보자.\n민감도와 특이도는 다음과 같이 구할 수 있다.\n\\[\\begin{align*}\n\\text{Sensitivity} & = \\frac{664}{664+120} =  0.8469 \\\\\n\\text{Specificity} & = \\frac{4891}{157+4891} =  0.9689\n\\end{align*}\\]\n위에서 구한 민감도와 특이도는 Butler-Laporte 기타 (2021) 에서 제시한 민감도(83.2%), 특이도(99.2%) 와 유사하지만 약간의 차이가 있다. 그 이유는 Butler-Laporte 기타 (2021) 는 모든 실험 결과를 단순하게 더한 것이 아니라 메타분석(meta analysis)을 사용하여 얻은 결과이기 때문이다. 메타분석은 같은 주제에 대한 여러 개의 독립적인 연구 결과들을 결합하여 결론을 추론하는 연구 방법이다.",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>진단의 평가</span>"
    ]
  },
  {
    "objectID": "notes/diagnose.html#민감도와-특이도",
    "href": "notes/diagnose.html#민감도와-특이도",
    "title": "4  진단의 평가",
    "section": "",
    "text": "양성인 사람을 얼마나 잘 양성으로 판단하는가?\n음성인 사람을 얼마나 잘 음성으로 판단하는가?\n\n\n\n\n\n\n표 4.1: 진단 기법의 실험 결과\n\n\n\n\n\n진단(T) / 질병(D)\n양성 (\\(D+\\))\n음성 (\\(D-\\))\n\n\n\n\n양성 (\\(T+\\))\n\\(TP\\)\n\\(FP\\)\n\n\n음성 (\\(T-\\))\n\\(FN\\)\n\\(TN\\)\n\n\n\n\n\n\n\n\n\\(TP\\) : True Positive\n\\(FP\\) : False Positive\n\\(FN\\) : False Nagative\n\\(TN\\) : True Negative\n\n\n\n\n\n\n\n그림 4.1: 코로나 검사의 민감도와 특이도\n\n\n\n\n\n\n\n\n\n\n표 4.2: 코로나 바이러스 검사법의 결과\n\n\n\n\n\n진단(T) / 질병(D)\n양성 (\\(D+\\))\n음성 (\\(D-\\))\n\n\n\n\n양성 (\\(T+\\))\n\\(664\\)\n\\(157\\)\n\n\n음성 (\\(T-\\))\n\\(120\\)\n\\(4981\\)",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>진단의 평가</span>"
    ]
  },
  {
    "objectID": "notes/diagnose.html#양성예측도와-음성예측도",
    "href": "notes/diagnose.html#양성예측도와-음성예측도",
    "title": "4  진단의 평가",
    "section": "4.2 양성예측도와 음성예측도",
    "text": "4.2 양성예측도와 음성예측도\n앞에서 살펴본 민감도와 특이도를 구하는 실험에서는 실험 대상자가 질병이 있는지 없는지 알고 있다. 하지만 실제 검사는 진단을 받는 사람이 질병이 있는지 모르는 상태에서 진행된다.\n따라서 우리가 정말 관심 있는 확률은 양성으로 진단된 사람이 실제로 양성인지?에 대한 확률이다.\n양성으로 판정되었을 때 실제로 병에 걸렸을 확률을 양성예측도(\\(PV+\\)) (predicted value of positive test, predictive value positive) 라고 부르며 음성으로 판정되었을 때 실제로 병에 걸리지 않았을 확률을 음성예측도(\\(PV-\\)) (predicted value of negative test, predicted value negative) 라고 부른다. 양성예측도와 음성예측도는 조건부 확률로 표현할 수 있다.\n\\[\\begin{align}\nPV+ & = P( D+ | T+) \\\\\nPV- & = P( D- | T-)\n\\end{align}\\]\n이제 앞에서 살펴본 민감도와 특이도도 다음과 같이 조건부 확률로 나타낼 수 있다.\n\\[\\begin{align}\n\\text{Sensitivity} & =  P(T+|D+) \\\\\n\\text{Specificity} & =  P(T-|D-)\n\\end{align}\\]\n이제 실제로 중요한 양성예측도와 음성예측도를 민감도와 특이도를 이용하여 유도해 보자. 두 확률은 사건과 조건이 바뀐 확률이기 때문에 베이즈 정리(Bayes’ Theorem)을 이용하여 구할 수 있다.\n일단 양성예측도를 구하는 식을 베이즈 정리를 적용하여 유도해 보자.\n\\[\nP( D+ | T+)  = \\frac{ P(T+|D+)P(D+)} {  P(T+|D+)P(D+) +  P(T+|D-)P(D-)}\n\\]\n위의 식에서 나타나는 확률 \\(P(D+)\\) 는 모집단에서 질병에 걸린 사람들의 비율을 의미하며 이를 유병률(prevalence) 이라고 부른다. 즉 양성예측도를 구하려면 질병의 유병률을 알아야 한다.\n다시 식을 정리해 보면 양성예측도에 대한 공식은 다음과 같다.\n\\[\\begin{align}\nP( D+ | T+)  & = \\frac{ P(T+|D+)P(D+)} {  P(T+|D+)P(D+) +  P(T+|D-)P(D-)} \\\\\n         & = \\frac{ P(T+|D+)P(D+)} {  P(T+|D+)P(D+) + [1- P(T-|D-)][1-P(D+)]} \\\\\n         & = \\frac{(민감도)(유병률)}{(민감도)(유병률) + (1-특이도)(1-유병률)}\n\\end{align}\\]\n비슷한 계산 방법으로 음성예측도는 다음과 같이 주어진다.\n\\[\\begin{align}\nP( D - | T -)  & = \\frac{ P(T -|D -)P(D -)} {  P(T-|D-)P(D-) +  P(T-|D+)P(D+)} \\\\\n         & = \\frac{ P(T-|D-)[1-P(D+)]} {  P(T-|D-)[1-P(D+)] + [1- P(T+|D-)] P(D+)} \\\\\n         & = \\frac{(특이도)(1- 유병률)}{(특이도)(1-유병률) + (1-민감도)(유병률)}\n\\end{align}\\]\n이제 표 4.2 의 결과를 이용하여 코로나 검사의 양성예측도와 음성예측도를 구해보자.\n코로나 유병률은 나라마다 다르고 추정하기도 힘들다. 따라서 쉽게 현재 까지 누적환자수를 전체 인구로 나눈 단순한 비율을 유병률로 사용해 보자(주의! 우리가 여기서 사용한 비율은 실제 유병률을 계산하는 방법과 다르다). 2021년 현재 누적 환자 수가 274,415 명이고 2020년 기준 총인구는 51,829,136 명이므로 유병률을 \\(274415/51829136= 0.0053\\) 이라고 하자.\n이제 표 4.2 의 결과를 이용하면 코로나 검사의 양성예측도와 음성예측도는 다음과 같이 추정할 수 있다.\n\\[\\begin{align*}\nP( D+ | T+)  & = \\frac{(민감도)(유병률)}{(민감도)(유병률) + (1-특이도)(1-유병률)} \\\\\n     & = \\frac{(0.8469 )(0.0053)}{(0.8469 )(0.0053) + (1-0.9689)(1-0.0053)} \\\\\n     & = 0.1267\n\\end{align*}\\]\n\n(0.8469 )*(0.0053)/((0.8469 )*(0.0053) + (1-0.9689)*(1-0.0053))\n\n[1] 0.1267108\n\n\n\\[\\begin{align}\nP( D - | T -)  & = \\frac{(특이도)(1- 유병률)}{(특이도)(1-유병률) + (1-민감도)(유병률)}\\\\\n& = \\frac{(0.9689)(1- 0.0053)}{(0.9689)(1-0.0053) + (1-0.8469)(0.0053)} \\\\\n& = 0.9992\n\\end{align}\\]\n\n(0.9689)*(1- 0.0053)/((0.9689)*(1-0.0053) + (1-0.8469)*(0.0053))\n\n[1] 0.9991588\n\n\n사실 코로나 유병률은 정확하게 알 수도 없고 시간에 따라 변할 것이다. 이제 다양한 유병률에 따라서 양성예측도와 음성예측도가 어떻게 변하는지 계산해 보자.\n\ncalpred &lt;- function(prev, sen, spe){\n    pred.pos &lt;- sen*prev/(sen*prev + (1-spe)*(1-prev))\n  pred.neg &lt;- spe*(1-prev)/(spe*(1-prev) + (1-sen)*(prev))\n  res &lt;- data.frame(sen, spe, prev, pred.pos, pred.neg)\n  colnames(res) &lt;- c(\"Sensitivity\", \"SPecificity\",\"Prevalnce\", \"Pred. Post.\", \"Pred. Nega.\")\n  res\n}\n\npreval.range &lt;- seq(0, 0.02, 0.002)\ncalpred(preval.range ,0.8469, 0.9689 )\n\n   Sensitivity SPecificity Prevalnce Pred. Post. Pred. Nega.\n1       0.8469      0.9689     0.000  0.00000000   1.0000000\n2       0.8469      0.9689     0.002  0.05174816   0.9996834\n3       0.8469      0.9689     0.004  0.09858220   0.9993658\n4       0.8469      0.9689     0.006  0.14117039   0.9990471\n5       0.8469      0.9689     0.008  0.18006506   0.9987273\n6       0.8469      0.9689     0.010  0.21572673   0.9984064\n7       0.8469      0.9689     0.012  0.24854242   0.9980845\n8       0.8469      0.9689     0.014  0.27883973   0.9977614\n9       0.8469      0.9689     0.016  0.30689786   0.9974372\n10      0.8469      0.9689     0.018  0.33295620   0.9971120\n11      0.8469      0.9689     0.020  0.35722119   0.9967856\n\n\n\ncalpred(0.0053, 0.8469, 0.9689  )\n\n  Sensitivity SPecificity Prevalnce Pred. Post. Pred. Nega.\n1      0.8469      0.9689    0.0053   0.1267108   0.9991588\n\n\n\n\n\n\nButler-Laporte, Guillaume, Alexander Lawandi, Ian Schiller, Mandy Yao, Nandini Dendukuri, Emily G McDonald, 와/과 Todd C Lee. 2021. “Comparison of saliva and nasopharyngeal swab nucleic acid amplification testing for detection of SARS-CoV-2: a systematic review and meta-analysis”. JAMA Intern Med 181 (3): 353–58.",
    "crumbs": [
      "분할표와 연관성",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>진단의 평가</span>"
    ]
  },
  {
    "objectID": "notes/anova.html",
    "href": "notes/anova.html",
    "title": "5  분산분석",
    "section": "",
    "text": "5.1 필요한 패키지\nlibrary(tidyverse)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(here)\n\n\nlibrary(agricolae)",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>분산분석</span>"
    ]
  },
  {
    "objectID": "notes/anova.html#일원배치법",
    "href": "notes/anova.html#일원배치법",
    "title": "5  분산분석",
    "section": "5.2 일원배치법",
    "text": "5.2 일원배치법\n일원배치법 실험((one-way factor design)에서는 하나의 요인(factor) A 의 효과를 측정한다. 요인 A 에 대하여 서로 다른 a 개의 수준(level), \\(A_1, A_2, \\dots, A_a\\))의 효과를 비교한다고 가정하자. 각 수준에 대하여 \\(r_i\\) 개의 반응값을 반복 측정한다.\n이제 \\(i\\) 번쨰 수준에서 측정된 \\(j\\) 번째 반응변수의 값을 \\(y_{ij}\\) 라고 하자. 일원배치법에서 측정된 자료들은 다음과 같은 모형을 가진다고 가정한다.\n\\[\ny_{ij} = \\mu_i + e_{ij} \\quad \\text{ where } \\quad e_{ij} \\sim N(0,\\sigma_E^2)\n\\tag{5.1}\\]\n여기서 오차항 \\(e_{ij}\\)는 모두 독립이다.\n모형 5.1 은 일반적으로 평균모형(mean model) 이라고 부르며 모형의 이름대로 \\(\\mu_i\\)는 \\(i\\)번째 수준에서 반응변수의 평균을 의미한다.\n\\[ E(y_{ij}) = E(\\mu_i + e_{ij}) = \\mu_i \\]\n이제 모형 5.1 을 변형하여 다른 형식의 모형을 만들어 보자.\n\\[\n\\begin{aligned}\ny_{ij} & = \\mu_i + e_{ij} \\\\\n      & = \\mu + (\\mu_i - \\mu) + e_{ij} \\\\\n      & = \\mu + \\alpha_i + e_{ij}\n\\end{aligned}\n\\]\n위의 모형에서 모수 \\(\\mu\\)는 반응변수의 전체 평균을 의미하며 \\(\\alpha_i = \\mu_i - \\mu\\)는 \\(i\\)번째 수준의 평균이 전체 평균과 어떻게 다른지 나타내는 수준의 상대적 효과를 의미한다.\n다음의 식으로 정의된 일원배치 모형을 주효과모형(main effect model) 이라고 부른다. 모수 \\(\\alpha_i\\)는 \\(i\\) 번째 집단의 효과(처리 효과; treatment effect)를 나타낸다고 할 수 있다.\n\\[\ny_{ij} = \\mu + \\alpha_i + e_{ij} \\text{ where } e_{ij} \\sim N(0,\\sigma_E^2)\n\\tag{5.2}\\] 여기서 오차항 \\(e_{ij}\\) 는 모두 독립이며 다음과 같은 제약조건이 있다.\n\\[\n\\sum_{i=1}^a \\alpha_i = 0\n\\tag{5.3}\\]\n제약조건 5.3 는 모수의 개수(\\(a+1\\))가 그룹의 개수(\\(a\\))보다 많아서 발생하는 문제를 해결하기 위하여 모수에 대한 제약 조건 1개를 고려해서 모수의 개수와 그룹의 개수를 맞추어준 것이다.\n제약조건 5.3 은 sum to zero조건이라고 부르며 문제를 해결하는 유일한 조건은 아니다. 예를 들어서 조건 5.3 을 대신하여 \\(\\alpha_1=0\\) 인 set to zero 조건을 사용할 수 있다.",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>분산분석</span>"
    ]
  },
  {
    "objectID": "notes/anova.html#가설",
    "href": "notes/anova.html#가설",
    "title": "5  분산분석",
    "section": "5.3 가설",
    "text": "5.3 가설\n집단의 모평균을 편의상 \\(\\mu_1, \\mu_2, \\cdots, \\mu_a\\) 이라고 하자. 평균모형 5.1 을 가정하고 집단들 사이에 차이가 있는지에 대한 가설은 다음과 같다.\n\\[ H_0: \\mu_1 = \\mu_2 =\\dots =\\mu_a \\quad \\text{vs.} \\quad H_1: \\text{ not } H_0 \\]\n위의 가설에서 주의할 점은 대립가설 \\(H_1\\)의 경우를 고려하면 평균들이 서로 다른 경우가 매우 다양하다는 것이다. 예를 들어 집단이 3개 인 경우 \\(\\mu_1 = \\mu_2  &lt; \\mu_3\\)일 수 도 있고 \\(\\mu_1 &lt; \\mu_2  &lt; \\mu_3\\) 있으며 이 외에 매우 다양한 경우들이 있다.\n이제 효과모형 5.2 을 고려하면 집단들 사이에 차이가 있는지에 대한 가설을 다음과 같이 바꿀수 있다. 집단에 대한 효과가 모두 0이 되면 집단 간의 평균에 대한 차이는 없다.\n\\[\nH_0: \\alpha_1 = \\alpha_2 =\\cdots=\\alpha_a =0  \\quad \\text{vs.} \\quad H_1: \\text{ not } H_0\n\\tag{5.4}\\]",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>분산분석</span>"
    ]
  },
  {
    "objectID": "notes/anova.html#변동의-분해",
    "href": "notes/anova.html#변동의-분해",
    "title": "5  분산분석",
    "section": "5.4 변동의 분해",
    "text": "5.4 변동의 분해\n이제 관측값이 가진 모든 변동을 집단 간의 변동(각 집단의 평균의 차이가 얼마나 나는지에 대한 통계량)과 집단 내의 변동(각 집단내에서 관측값들의 퍼진 정도)를나누어 파악할 수 있는 통계량을 찾아서 검정 통계량을 구성해 보자.\n일단 각 집단의 반복 측정값의 횟수는 모두 같다고 가정하자(\\(r_i=r\\)). 전체 평균과 집단의 평균을 다음과 같이 정의하자.\n\\[ \\bar{\\bar {y}} =  \\frac{\\sum_{i=1}^a \\sum_{j=1}^r y_{ij}}{ar} =\\frac{T}{ar}, \\quad  \\bar {y}_{i.} =   \\frac{\\sum_{j=1}^r y_{ij}}{r} = \\frac{T_{i.}}{r} \\]\n이제 하나의 관측값 \\(y_{ij}\\)과 전체 평균 \\(\\bar{\\bar {y}}\\) 간의 편차(deviation)를 다음과 같이 분해해 보자.\n\\[\n\\underbrace{ y_{ij} - \\bar{\\bar {y}} }_{\\text{total deviation}}  = \\underbrace{ ( y_{ij} - \\bar {y}_{i.} )}_{\\text{within-group deviation}} + \\underbrace{(\\bar {y}_{i.} - \\bar{\\bar {y}} )}_{\\text{between-group deviation}}\n\\tag{5.5}\\]\n식 5.5 에서 집단 평균과 총 평균의 편차 (\\(\\bar {y}_{i.} - \\bar{\\bar {y}}\\))는 처리의 효과를 측정할 수 있는 통계량이다. 집단 간의 차이를 반영하는 양으로 처리 효과 \\(\\alpha_i\\)들에 의하여 발생한다.\n집단 내의 관측값과 집단 평균의 차이 (\\(y_{ij} - \\bar {y}_{i.}\\))는 집단 내의 변동을 나타내는 통계량으로 측정 오차 \\(e_{ij}\\)에 의하여 발생한다.\n식 5.5 의 각 편차들은 양수와 음수로서 부호를 가지기 때문에 이를 변동으로 표현하기 위하여 차이를 제곱하여 합친 제곱합(sum of squares)을 고려해 보자.\n\\[\n\\begin{aligned}\n\\sum_{i=1}^a \\sum_{j=1}^r (y_{ij} - \\bar{\\bar {y}})^2\n    & = \\sum_{i=1}^a \\sum_{j=1}^r \\left [ ( y_{ij} - \\bar {y}_{i.} ) + (\\bar {y}_{i.} - \\bar{\\bar {y}} ) \\right ]^2 \\\\\n    & = \\sum_{i=1}^a \\sum_{j=1}^r ( y_{ij} - \\bar {y}_{i.} )^2 + \\sum_{i=1}^a \\sum_{j=1}^r (\\bar {y}_{i.} - \\bar{\\bar {y}} )^2 + 2   \\sum_{i=1}^a \\sum_{j=1}^r ( y_{ij} - \\bar {y}_{i.} ) (\\bar {y}_{i.} - \\bar{\\bar {y}} ) \\\\\n    & = \\sum_{i=1}^a \\sum_{j=1}^r ( y_{ij} - \\bar {y}_{i.} )^2 + \\sum_{i=1}^a r (\\bar {y}_{i.} - \\bar{\\bar {y}} )^2 + 0 (why?) \\\\\n\\end{aligned}\n\\]\n결과적으로 다음과 같은 변동의 분해를 제곱합의 형식으로 얻을 수 있다.\n\\[\n\\underbrace{ \\sum_{i=1}^a \\sum_{j=1}^r (y_{ij} - \\bar{\\bar {y}})^2  }_{\\text{total variation}}  = \\underbrace{ \\sum_{i=1}^a \\sum_{j=1}^r ( y_{ij} - \\bar {y}_{i.} )^2 }_{\\text{within-group variation}} + \\underbrace{\\sum_{i=1}^a \\sum_{j=1}^r (\\bar {y}_{i.} - \\bar{\\bar {y}} )^2 }_{\\text{between-group variation}}\n\\tag{5.6}\\]\n분해식 5.6 에서 나타난 각 제곱합에 대한 이름과 의미를 살펴보자.\n\n\\(SST\\) 를 총 제곱합(Total Sum of Squares)이라고 부르며 자료의 전체 변동을 의미한다.\n\n\\[ SST = \\sum_{i=1}^a \\sum_{j=1}^r (y_{ij} - \\bar{\\bar {y}})^2 \\]\n\n\\(SSE\\) 를 잔차 제곱합(Residual Sum of Squares)이라고 부르며 관측 오차에 발생된 집단 내의 변동 또는 급내 변동(within-group variation)을 의미한다.\n\n\\[ SSE = \\sum_{i=1}^a \\sum_{j=1}^r  ( y_{ij} - \\bar {y}_{i.} )^2 \\]\n\n\\(SSA\\) 를 처리 제곱합(Treatment Sum of Squares)이라고 부르며 처리들의 차이로 발생하는 변동으로거 집단 간의 변동 또는 급간 변동(bwtween-group variation)을 의미한다.\n\n\\[ SSA = \\sum_{i=1}^a \\sum_{j=1}^r (\\bar {y}_{i.} - \\bar{\\bar {y}} )^2 =\\sum_{i=1}^a r (\\bar {y}_{i.} - \\bar{\\bar {y}} )^2 \\]\n이제 분해식 5.6 을 다음과 같이 나타낼수 있다.\n\\[\nSST = SSA + SSE\n\\tag{5.7}\\]\n위의 분해식의 통계량들을 보면 다음과 같은 사실을 알수 있다.\n\n집단 간의 변동의 크기를 나타내는 처리제곱합(\\(SSA\\))이 커질수록 집단 간의 평균이 유의한 차이가 난다는) 증거가 강해진다.\n위의 현상을 다시 말하면, 집단내의 변동의 크기를 나타내는 오차제곱합(\\(SSE\\))이 작아질수록 집단 간의 평균이 유의한 차이가 증거가 강해진다.\n총제곱합은 자료의 전체 변동을 나타내며 그룹을 어떻게 나누건 그 값은 언제나 일정하다.\n총제곱합(\\(SST\\))은 처리제곱합(\\(SSA\\))과 오차제곱합(\\(SSE\\))의 합이다.\n따라서 처리제곱합이 커지면 오차제곱합이 상대적으로 작아지는 현상을 나타낸다. 또한 처리제곱합이 작아지면 오차제곱합이 상대적으 커지는 현상을 나타낸다.\n처리제곱합과 오차제곱합의 비율로 집단 간의 차이를 추론할 수 있다.",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>분산분석</span>"
    ]
  },
  {
    "objectID": "notes/anova.html#자유도",
    "href": "notes/anova.html#자유도",
    "title": "5  분산분석",
    "section": "5.5 자유도",
    "text": "5.5 자유도\n제곱합은 편차(deviation)의 제곱들을 더한 형태로서 각 제곱합들에 대하여 해당하는 자유도(degrees of freedom; df 또는 \\(\\phi\\)로 표기)를 구할 수 있다.\n제곱합의 자유도 = 제곱합을 구성하는 편차의 개수 – 선형제약 조건의 개수 \n각 제곱합에 대한 선형제약조건은 편차들의 합이 0이 되는 조건이다. 이제 식 5.7 에 주어진 제곱합의 자유도에 대한 정보를 다음과 같이 정리할 수 있다.\n\n\n\n\n\n\n\n\n\n\n제곱합\n편차의 개수\n제약조건\n제약조건의 수\n자유도\n\n\n\n\n\\(SST\\)\n\\(ar\\)\n\\(\\sum_{i=1}^a \\sum_{j=1}^r (y_{ij} - \\bar{\\bar {y}})=0\\)\n1\n\\(\\phi_T= ar-1\\)\n\n\n\\(SSA\\)\n\\(a\\)\n\\(\\sum_{i=1}^a (\\bar {y}_{i.} - \\bar{\\bar {y}} ) =0\\)\n1\n\\(\\phi_A=a-1\\)\n\n\n\\(SSE\\)\n\\(ar\\)\n\\(\\sum_{j=1}^r ( y_{ij} - \\bar {y}_{i.} ) =0, i=1,2,..,a\\)\na\n\\(\\phi_E=ar-a\\)\n\n\n\n반드시 유의해야 할 점은 총제곱합의 자유도는 처리제곱합의 자유도와 오차제곱합의 자유도의 합과 같다는 것이다. 이를 이용하면 두 개의 자유도만 구해면 나머지 하나의 자유도를 쉽게 구할 수 있다.",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>분산분석</span>"
    ]
  },
  {
    "objectID": "notes/anova.html#평균제곱합과-f-통계량",
    "href": "notes/anova.html#평균제곱합과-f-통계량",
    "title": "5  분산분석",
    "section": "5.6 평균제곱합과 F-통계량",
    "text": "5.6 평균제곱합과 F-통계량\n이제 가설 5.4 을 검정하기 위한 통계량을 구성해 보자. 먼저 다음과 같은 제곱합들을 각 자유도로 나눈 평균제곱합(Mean Sum of Squares)를 정의한다.\n\\[\nMSA = \\frac{SSA}{\\phi_A}, \\quad MSE =\\frac{SSE}{\\phi_E}\n\\tag{5.8}\\]\n집단 간의 변동과 집단 내의 변동의 상대적 비율로 그룹 간의 차이를 검정할 수 있다는 개념을 확장하여 다음과 같은 F-통계량 \\(F_0\\) 를 만들어 보자.\n\\[\nF_0 =  \\frac{MSA}{MSE} = \\frac{\\text{between-group variation}} {\\text{within-group variation}}\n\\tag{5.9}\\]\n위 식 5.9 에서 정의된 F-통계량은 그룹 간에 평균의 차이가 클수록, 그룹 내의 변동이 작을 수록 그 값이 커진다. 따라서 F-통계량의 값이 크면 클수록 귀무가설에 반대되는 증거가 강해진다.\n이렇게 전체의 변동을 집단 간의 변동과 집단 내의 변동으로 나누어 집단 간의 평균의 차이를 추론하는 방법을 분산분석(Analysis of Variance, ANOVA)이라고 한다.",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>분산분석</span>"
    ]
  },
  {
    "objectID": "notes/anova.html#분산분석을-이용한-f-검정",
    "href": "notes/anova.html#분산분석을-이용한-f-검정",
    "title": "5  분산분석",
    "section": "5.7 분산분석을 이용한 F-검정",
    "text": "5.7 분산분석을 이용한 F-검정\n이제 식 5.9 에서 정의된 F-통계량을 이용하여 가설 5.4 를 검정하는 통계적 방법을 만들어 보자. 일단 두 제곱합의 통계적 성질은 다음과 같다.\n\n잔차 제곱합을 오차항의 분산으로 나눈 통계량은 자유도가 \\(\\phi_E\\) 를 가지는 카이제곱 분포를 따른다.\n\\[ \\frac{SSE}{\\sigma_E^2}  \\sim \\chi^2(\\phi_E) \\]\n귀무가설이 참인 경우 처리 제곱합을 오차항의 분산으로 나눈 통계량은 자유도가 \\(\\phi_A\\) 를 가지는 카이제곱 분포를 따른다.\n\\[ \\frac{SSA}{\\sigma_E^2}  \\sim \\chi^2(\\phi_A) \\quad \\text{ under } H_0  \\]\n잔차 제곱합과 처리 제곱합은 서로 독립이다.\n\n따라서 귀무가설이 참인 경우 F-통계량은 자유도가 \\(\\phi_A, \\phi_E\\)를 가지는 F-분포를 따른다.\n\\[\nF_0 =  \\frac{MSA}{MSE} = \\frac{ \\tfrac{SSA/\\sigma_E^2}{\\phi_A}} {\\tfrac{SSE/\\sigma_E^2}{\\phi_E }}  \\sim F(\\phi_A, \\phi_E) \\quad \\text{ under } H_0  \n\\tag{5.10}\\]\n유의수준 \\(\\alpha\\)에서 F-통계량이 기각역을 벗어나면 귀무가설을 기각한다.\n\\[ \\text{ Reject } H_0 \\text{ if } F_0 &gt; F(1-\\alpha, \\phi_A, \\phi_E)  \\]\n또는 다음과 같이 계산된 p-값이 유의수준 \\(\\alpha\\) 보다 작으면 귀무가설을 기각한다.\n\\[ p-value = P[F(\\phi_A, \\phi_E) &gt; F_0  ]   \\]\nF-통계량을 정의할 때 편리하고 유용하게 사용되는 것이 다음과 같은 분산분석표(ANOVA table)이다.\n\n\n\n\n\n\n\n\n\n\n\n요인\n제곱합\n자유도\n평균제곱합\n\\(F_0\\)\np-값\n\n\n\n\n처리\n\\(SSA\\)\n\\(\\phi_A = a-1\\)\n\\(MSA=SSA/\\phi_A\\)\n\\(F_0=MSA/MSE\\)\n\\(P[F(\\phi_A, \\phi_E) &gt; F_0  ]\\)\n\n\n잔차\n\\(SSE\\)\n\\(\\phi_E=a(r-1)\\)\n\\(MSE=SSE/\\phi_E\\)\n\n\n\n\n총합\n\\(SST\\)\n\\(\\phi_T =  ar-1\\)",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>분산분석</span>"
    ]
  },
  {
    "objectID": "notes/anova.html#분산분석-후의-추정",
    "href": "notes/anova.html#분산분석-후의-추정",
    "title": "5  분산분석",
    "section": "5.8 분산분석 후의 추정",
    "text": "5.8 분산분석 후의 추정\n분산분석에서 고려한 요인 A의 수준에 따라서 반응값의 평균에 유의한 차이가 있다고 결론이 나면 그룹 간의 모평균을 차이에 대한 더 자세한 정보가 필요하다. 즉 집단들의 평균이 서로 유의하게 다르거나 같은지에 대한 정보를 얻는 것이 중요하다.\n일단 모집단의 분산 \\(\\sigma_E^2\\) 에 대한 추정은 잔차제곱합의 분포를 이용하면 다음과 같은 불편추정량을 얻을 수 있다.\n\\[ \\hat \\sigma_E^2 = MSE, \\quad E(MSE) = \\sigma_E^2 \\]\n다음으로 각 수준(집단)에 대한 평균에 대한 추정량은 표본평균 \\(\\bar {y}_{i.}\\) 이며\n\\[ \\hat \\mu_i = \\widehat {\\mu + \\alpha_i} = \\bar {y}_{i.}  \\quad E(\\bar {y}_{i.}) =\\mu_i \\]\n\\(100(1-\\alpha)\\) % 신뢰구간(confidence interval)은 다음과 같이 주어진다.\n\\[ \\bar {y}_{i.} \\pm t(1-\\alpha/2, \\phi_E) \\sqrt{ \\frac{MSE}{r}} \\]\n야기서 \\(t(1-\\alpha/2, \\phi_E)\\)는 자유도 \\(\\phi_E\\)를 가지는 t-분포의 \\(1-\\alpha/2\\) 분위수를 의미한다.\n이제 두 개의 수준에 대한 평균의 차이에 대한 통계적 추론을 생각해 보자. 수준 \\(A_i\\)와 \\(A_j\\)의 평균의 차이에 대한 추정과 검정을 하려고 한다.\n\\[ \\delta_{ij} = \\mu_i-\\mu_j = \\alpha_i - \\alpha_j \\]\n두 평균의 차이 \\(\\delta_{ij}\\) 에 대한 \\(100(1-\\alpha)\\) % 신뢰구간은 다음과 같이 주어진다.\n\\[\n( \\bar {y}_{i.} - \\bar {y}_{j.})   \\pm t(1-\\alpha/2, \\phi_E) \\sqrt{ \\frac{2MSE}{r}}\n\\tag{5.11}\\]\n신뢰구간 5.11 에서 두 개의 표본 평균 \\(\\bar {y}_{i.}\\)와 \\(\\bar {y}_{j.}\\) 은 서로 독립인 것에 유의하자.\n이제 마지막으로 두 평균의 차이 \\(\\delta_{ij}\\) 에 대한 가설을 검정하여고 한다.\n\\[ H_0 : \\alpha_i = \\alpha_j \\quad \\text{ vs. } \\quad H_1: \\alpha_i \\ne \\alpha_j \\]\n유의 수준 \\(\\alpha\\)에서 다음과 같은 조건을 만족하면 위의 귀무가설을 기각한다.\n\\[\n\\left | \\bar {y}_{i.} - \\bar {y}_{j.} \\right | &gt; t(1-\\alpha/2, \\phi_E) \\sqrt{ \\frac{2MSE}{r}}\n\\tag{5.12}\\]\n식 5.12 에서 주어진 귀무 가설 \\(\\delta_{ij}=0\\) 을 기각하는 조건은 식 5.11 에 주어진 신뢰구간이 0 을 포함하지 않는 조건과 동일하다.\n식 5.12 에서 검정을 위한 조건의 우변을 최소유의차(least significant difference; LSD) 라고 부른다. 두 수준의 차이가 유의하려면 두 평균 차이의 절대값이 최소한 최소유의차의 값보다 커야한다.\n\\[  \\text{LSD} =t(1-\\alpha/2, \\phi_E) \\sqrt{ \\frac{2MSE}{r}}  \\]",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>분산분석</span>"
    ]
  },
  {
    "objectID": "notes/anova.html#diabetes",
    "href": "notes/anova.html#diabetes",
    "title": "5  분산분석",
    "section": "5.9 예제: 저혈당 임상실험",
    "text": "5.9 예제: 저혈당 임상실험\n부교재 Jaewon Lee (2005) 의 5장에 나오는 당뇨병 환자에 대한 예제를 이용하여 치료군 간의 차이를 살펴보자. 한 연구자는 저혈당에 걸린 20명의 환자에 대하여 혈당을 높이는 서로 다른 5개의 약품 효능을 비교하고자 한다. 환자 20명을 5개의 그룹(treat)으로 나누어 각각의 약품을 이용하여 1개월 간 치료를 실시하였다.\n치로 시작전에 모든 환자의 혈당을 측정하고(baseline) 1개월의 치료 기간이 지난 후 혈당을 측정하였다(response).\n임상시험자료를 다음과 같이 읽어서 data.frame 형식으로 저장한다.\n\ndiabetes &lt;- read.csv(here(\"data\", \"chapter-5-data.txt\"), sep='', header = F)\ncolnames(diabetes) &lt;- c(\"treat\", \"baseline\", \"response\")\ndiabetes$treat&lt;- factor(diabetes$treat)\ndiabetes &lt;- diabetes %&gt;% arrange(treat)\n\n저혈당 환자에 대한 임상실험에서 얻은 자료는 다음과 같다.\n\ndiabetes %&gt;%\n    kbl(caption = \"저혈당 환자에 대한 임상실험 결과\") %&gt;%\n    kable_styling(bootstrap_options = \"striped\", full_width = F, position = \"center\",\n        font_size = 12)\n\n\n저혈당 환자에 대한 임상실험 결과\n\n\ntreat\nbaseline\nresponse\n\n\n\n\n1\n27.2\n32.6\n\n\n1\n33.0\n37.7\n\n\n1\n22.0\n36.6\n\n\n1\n26.8\n31.0\n\n\n2\n28.6\n33.8\n\n\n2\n26.5\n30.7\n\n\n2\n26.8\n31.7\n\n\n2\n26.8\n30.4\n\n\n3\n28.6\n35.2\n\n\n3\n23.2\n28.9\n\n\n3\n22.4\n29.1\n\n\n3\n24.4\n30.2\n\n\n4\n29.3\n35.0\n\n\n4\n30.3\n36.4\n\n\n4\n21.8\n27.0\n\n\n4\n24.3\n30.5\n\n\n5\n20.4\n24.6\n\n\n5\n25.1\n30.3\n\n\n5\n19.6\n23.4\n\n\n5\n18.1\n21.8\n\n\n\n\n\n\n\n각 치료그룹의 치료 후 혈당(response)의 치료집단 별 기초통계량을 구해보자.\n\ndfsumm &lt;- diabetes %&gt;%\n    group_by(treat) %&gt;%\n    summarise(mean = mean(response), median = median(response), sd = sd(response),\n        min = min(response), max = max(response))\ndfsumm\n\n# A tibble: 5 × 6\n  treat  mean median    sd   min   max\n  &lt;fct&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 1      34.5   34.6  3.19  31    37.7\n2 2      31.6   31.2  1.54  30.4  33.8\n3 3      30.8   29.6  2.96  28.9  35.2\n4 4      32.2   32.8  4.30  27    36.4\n5 5      25.0   24    3.70  21.8  30.3\n\n\n치료집단 별로 치료그룹의 치료 후 혈당(response)의 분포를 다음과 상자그림으로 비교해보자.\n\nggplot(diabetes, aes(treat, response)) +\n  geom_boxplot() + \n  geom_line(data=dfsumm, aes(x=treat, y=mean, group=1), linewidth=1.5, col=\"#9ACBF9\") +\n  geom_point(data=dfsumm, aes(x=treat, y=mean), col=\"darkblue\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n이제 위에서 제시한 F-검정을 이용하여 약품별로 치료 후 혈당의 차이가 있는지 검정해보자.\n\\[ H_0: \\mu_1=\\mu_2=\\mu_3=\\mu_4 \\quad \\text{ vs. }\\quad H_1: \\text{ not } H_0 \\]\n\nanova.res &lt;- aov(response~treat,data=diabetes) \nsummary(anova.res)\n\n            Df Sum Sq Mean Sq F value Pr(&gt;F)  \ntreat        4  198.4   49.60   4.643 0.0122 *\nResiduals   15  160.3   10.68                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n위의 분산분석표에서 p-값이 유의수준 5% 보다 매우 작으므로 약품별로 치료 후 혈당의 평균이 같다는 귀무가설을 기각한다. 따라서 5개의 집단의 치료 후 혈당 평균은 유의하게 다르다고 할 수 있다. 여기서 유의할 점은 ANOVA를 이용한 F-검정은 그룹 간의 차이가 있다는 것을 의미하지만 어떻게 다른지에 대한 정보를 주지 않는다.\n최소유의차(LSD) 방법에 의하여 처리 간의 평균을 신뢰구간을 구하고 차이가 있는지 검정할 수 있다. LSD.test() 함수는 agricolae 패키지에서 제공한다.\n\n### Mean of response by factor\nresult1 &lt;- LSD.test(anova.res, \"treat\", group=FALSE, console = TRUE)\n\n\nStudy: anova.res ~ \"treat\"\n\nLSD t Test for response \n\nMean Square Error:  10.68417 \n\ntreat,  means and individual ( 95 %) CI\n\n  response      std r       se     LCL     UCL  Min  Max    Q25   Q50    Q75\n1   34.475 3.188913 4 1.634332 30.9915 37.9585 31.0 37.7 32.200 34.60 36.875\n2   31.650 1.537314 4 1.634332 28.1665 35.1335 30.4 33.8 30.625 31.20 32.225\n3   30.850 2.955785 4 1.634332 27.3665 34.3335 28.9 35.2 29.050 29.65 31.450\n4   32.225 4.297577 4 1.634332 28.7415 35.7085 27.0 36.4 29.625 32.75 35.350\n5   25.025 3.698986 4 1.634332 21.5415 28.5085 21.8 30.3 23.000 24.00 26.025\n\nAlpha: 0.05 ; DF Error: 15\nCritical Value of t: 2.13145 \n\nComparison between treatments means\n\n      difference pvalue signif.        LCL       UCL\n1 - 2      2.825 0.2405         -2.1014081  7.751408\n1 - 3      3.625 0.1376         -1.3014081  8.551408\n1 - 4      2.250 0.3458         -2.6764081  7.176408\n1 - 5      9.450 0.0010     ***  4.5235919 14.376408\n2 - 3      0.800 0.7341         -4.1264081  5.726408\n2 - 4     -0.575 0.8069         -5.5014081  4.351408\n2 - 5      6.625 0.0118       *  1.6985919 11.551408\n3 - 4     -1.375 0.5608         -6.3014081  3.551408\n3 - 5      5.825 0.0235       *  0.8985919 10.751408\n4 - 5      7.200 0.0071      **  2.2735919 12.126408\n\n\n최소유의차(LSD) 방법에 의한 평균의 차이에 대한 결과를 이용하여 처리를 다음과 같이 그룹화 하여 보여줄 수 있다.\n\nresult2 &lt;- LSD.test(anova.res, \"treat\", group=TRUE, console = TRUE)\n\n\nStudy: anova.res ~ \"treat\"\n\nLSD t Test for response \n\nMean Square Error:  10.68417 \n\ntreat,  means and individual ( 95 %) CI\n\n  response      std r       se     LCL     UCL  Min  Max    Q25   Q50    Q75\n1   34.475 3.188913 4 1.634332 30.9915 37.9585 31.0 37.7 32.200 34.60 36.875\n2   31.650 1.537314 4 1.634332 28.1665 35.1335 30.4 33.8 30.625 31.20 32.225\n3   30.850 2.955785 4 1.634332 27.3665 34.3335 28.9 35.2 29.050 29.65 31.450\n4   32.225 4.297577 4 1.634332 28.7415 35.7085 27.0 36.4 29.625 32.75 35.350\n5   25.025 3.698986 4 1.634332 21.5415 28.5085 21.8 30.3 23.000 24.00 26.025\n\nAlpha: 0.05 ; DF Error: 15\nCritical Value of t: 2.13145 \n\nleast Significant Difference: 4.926408 \n\nTreatments with the same letter are not significantly different.\n\n  response groups\n1   34.475      a\n4   32.225      a\n2   31.650      a\n3   30.850      a\n5   25.025      b\n\n\n\nresult2$groups\n\n  response groups\n1   34.475      a\n4   32.225      a\n2   31.650      a\n3   30.850      a\n5   25.025      b\n\nplot(result2)\n\n\n\n\n\n\n\n\n\n\n\n\nJaewon Lee, Hanna Yu, Mira Park. 2005. 생명과학연구를 위한 통계적 방법. 1st ed. 자유아카데미.",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>분산분석</span>"
    ]
  },
  {
    "objectID": "notes/ancova.html",
    "href": "notes/ancova.html",
    "title": "6  공분산분석",
    "section": "",
    "text": "6.1 필요한 패키지\nlibrary(tidyverse)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(here)\n\nlibrary(car)\nlibrary(agricolae)",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>공분산분석</span>"
    ]
  },
  {
    "objectID": "notes/ancova.html#공분산분석-개요",
    "href": "notes/ancova.html#공분산분석-개요",
    "title": "6  공분산분석",
    "section": "6.2 공분산분석 개요",
    "text": "6.2 공분산분석 개요\n서로 다른 집단을 비교하는 실험이나 관측연구에서 관심이 있는 처리(treatment)나 요인(factor)뿐만 아니라 다른 예측변수들도 반응변수에 영향을 미친다. 이러한 예측변수들의 영향을 제거하기 위한 방법은 여러가지가 있지만 실험인 경우 임의화 방법(randomization)으로 그 영향을 상쇄시킬 수 도 있고 관측연구인 경우에는 사례-대조연구 방법을 이용하여 그 영향을 최소화하려고 노력을 한다.\n하지만 많은 경우에 여러 가지 변수들이 반응변수에 영향을 미친다. 이러한 경우에 이러한 독립변수(또는 예측변수)를 모형에 포함시켜서 그 영향을 반영하고 동시에 자료의 변동을 부가적으로 설명해주는 방법이 공분산 분석(analysis of covariance; ANCOVA)이다.\n공분산 분석에서 고려되는 예측변수를 공변량(covariate) 이라고 부른다.\n대부분의 실험연구에는 실험 전에 여러 가지 점수를 측정하는데 이 경우 이러한 점수를 공변량으로 모형에 포함시켜주는 것이 좋다 (예: 실험 전 상태에 대한 점수, 시험점수, IQ 점수). 또한 임상실험을 여러 개의 병원에서 진행하는 경우 병원 효과를 공변량으로 자주 사용한다.\n공분산 모형의 주요한 장점은 반응변수에 대해 설명력이 높은 공변량을 사용하게 되면 잔차제곱합이 감소하여 처리의 효과에 대한 검정력을 높일 수 있다.\n여기서 주의해야 할 점은 공변량과 처리는 독립이 되야한다는 점이다. 만약 처리의 결과가 공변량에 영향을 미치게 되면 이러한 공변량은 모형에 포함시키는 것이 부적절하다.\n예를 들어 자동차정비 교육을 위한 두 가지 학습법을 비교하는 실험을 생각해 보자. 학생들을 임의로 두 가지 학습법 중 하나를 선택하여 3개월 동안 교육을 받게 하고 시험을 보아 평균 점수의 차이를 알아보았다. 이 떄 공변량으로 총 학습시간을 고려하였는데 학습법의 선택이 총 학습시간에 영향을 줄 수 있다. 즉 고려된 학습법 중 하나는 컴퓨터를 이용한 학습법이며 이 학습법에 배정된 학생들은 컴퓨터 사용를 익히는 시간까지 학습시간에 포함되는 것이 나타났다. 이렇게 공변량이 처리에 의해 영향을 받는 경우(교호작용이 있는 경우)는 이를 모형에 포함시키는 것은 위험하다.",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>공분산분석</span>"
    ]
  },
  {
    "objectID": "notes/ancova.html#공분산분석의-모형",
    "href": "notes/ancova.html#공분산분석의-모형",
    "title": "6  공분산분석",
    "section": "6.3 공분산분석의 모형",
    "text": "6.3 공분산분석의 모형\n이제 일원배치에서 하나의 공변량이 있는 공분산분석의 모형은 일원배치 모형에 공변량 \\(x\\)의 효과를 다음과 같이 더해주는 것이다.\n\\[\ny_{ij} = \\mu + \\alpha_i + \\beta(x_{ij} - \\bar x_{..}) + e_{ij},\n\\quad i=1,2,\\dots,a, ~~ j=1,2,\\dots,r\n\\tag{6.1}\\]\n모형 6.1 에서 \\(x_{ij}\\)는 관측값 \\(y_{ij}\\)의 공변량이며 \\(\\bar x_{..} = \\sum_{i=1}^a \\sum_{j=1}^r x_{ij}\\)로 공변량의 전체 평균이다. 위의 효과모형은 다음과 같이 평균모형으로 나타낼 수 있다. 어떤 모형이든 모수에 대한 가설 검정의 결과는 동일하다.\n\\[\n\\begin{aligned}\ny_{ij} & = \\mu + \\alpha_i + \\beta(x_{ij} - \\bar x_{..}) + e_{ij} \\\\\n  & = \\beta_0 + \\alpha_i + \\beta x_{ij} + e_{ij} \\\\\n  & = \\beta_{0i} + \\beta x_{ij} + e_{ij}\n\\end{aligned}\n\\]\n모형 6.1 에서 각 모수의 추정은 ANOVA 모형에서와 같이 최소제곱법을 이용하여 추정하며 부가조건 \\(\\sum_i \\alpha_i =0\\) 을 이용하면 다음과 같은 추정량을 얻을 수 있다\n\\[\n\\begin{aligned}\n\\hat \\mu & = \\bar y_{..} \\\\\n\\hat \\alpha_i & =\\bar y_{i.} - \\bar y_{..} -\\hat \\beta(\\bar x_{i.} -\\bar x_{..}) \\\\\n\\hat \\beta & =  \\frac{ \\sum_i \\sum_j (x_{ij} - \\bar x_{i.})(y_{ij}-\\bar y_{i.})}{\\sum_i \\sum_j (x_{ij} - \\bar x_{i.})^2}\n\\end{aligned}\n\\]\n각 집단의 차이와 공변량의 기울기에 대한 통계적 가설 검정에 관심이 있는 경우 공분산분석은 다음과 같이 공변량의 평균으로 보정하지 않는 모형을 사용해도 무방하다.\n\\[\ny_{ij} = \\mu + \\alpha_i + \\beta x_{ij} + e_{ij},\n\\quad i=1,2,\\dots,a, ~~ j=1,2,\\dots,r\n\\tag{6.2}\\]",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>공분산분석</span>"
    ]
  },
  {
    "objectID": "notes/ancova.html#가설검정",
    "href": "notes/ancova.html#가설검정",
    "title": "6  공분산분석",
    "section": "6.4 가설검정",
    "text": "6.4 가설검정\n공분산 분석 모형에서는 다음과 같은 두 가지 가설을 검정할 수 있다. 분산 분석 모형에서와 같이 각 그룹의 평균에 대한 검정을 할 수 있고\n\\[\nH_0: \\alpha_1 = \\alpha_2 =...=\\alpha_a =0  \\quad \\text{vesus} \\quad H_1: \\text{ not } H_0\n\\]\n또한 공변량의 효과에 대한 검정도 할 수 있다.\n\\[\nH_0: \\beta =0  \\quad \\text{vesus} \\quad H_1: \\beta \\ne 0\n\\tag{6.3}\\]\n가설검정을 위한 제곱합들을 다음과 같이 정의하자.\n\\[\n\\begin{aligned}\nS_{xx(i)} & = \\sum_{j=1}^r (x_{ij} - \\bar x_{i.})^2 \\\\\nS_{yy(i)} & = \\sum_{j=1}^r (y_{ij} - \\bar y_{i.})^2 \\\\\nS_{xy(i)} & = \\sum_{j=1}^r (x_{ij} - \\bar x_{i.})(y_{ij} - \\bar y_{i.}) \\\\\nS_{xx} & = \\sum_{i=1}^a \\sum_{j=1}^r (x_{ij} - \\bar x)^2 \\\\\nS_{yy} & = \\sum_{i=1}^a \\sum_{j=1}^r (y_{ij} - \\bar y)^2 \\\\\nS_{xy} & = \\sum_{i=1}^a \\sum_{j=1}^r (x_{ij} - \\bar x)(y_{ij} - \\bar y)\\\\\nSST & = \\sum_{i=1}^a \\sum_{j=1}^r (y_{ij} - \\bar y)^2 \\\\\nSS_T & = \\frac{(S_{xx})(S_{yy}) -(S_{xy})^2}{S_{xx}} -SSE \\\\\nSS_X & = \\sum_{i=1}^a S_{yy(i)} -SSE \\\\\nSSE & = \\frac{(\\sum_i S_{xx(i)})(\\sum_i S_{yy(i)})-(\\sum_i S_{xy(i)})^2}{\\sum_i S_{xx(i)}}\n\\end{aligned}\n\\]\n이제 위의 두 검정은 다음과 같은 분산분석표를 이용한 F-검정법으로 수행할 수 있다. \\(n=ar\\)으로 총 관측값의 개수이다.\n\n공분산분석 모형의 분산분석표\n\n\n\n\n\n\n\n\n\n요인\n제곱합\n자유도\n평균제곱합\nF\n\n\n\n\n\n\n\n\n\n\n\n공변량\n\\(SS_X\\)\n1\n\\(MS_X = SS_X/1\\)\n\\(F_1 = MS_X / MSE\\)\n\n\n처리\n\\(SS_T\\)\na-1\n\\(MS_T = SS_T/(a-1)\\)\n\\(F_2 = MS_T / MSE\\)\n\n\n오차\n\\(SSE\\)\nn-a-1\n\\(MSE = SSE/(n-a-1)\\)\n\n\n\n총합\n\\(SST\\)\nn-1\n\n\n\n\n\n위의 분산분석표에서 공변량 효과에 대한 가설 6.3 은 다음과 같이 p-값을 계산하여 검정할 수 있다.\n\\[ p-value = P[ F(1, n-a-1) &gt; F_1 ] \\]\n또한 그룹의 평균에 대한 검정은 ANOVA 검정과 유사하게 p-값을 계산하여 검정할 수 있다.\n\\[ p-value = P[ F(a-1, n-a-1) &gt; F_2 ] \\]\n위의 두 F-검정에 쓰이는 F-분포의 두 번째 자유도가 ANOVA 검정에서 사용되는 자유도(\\(n-a\\))보다 하나가 작음(\\(n-a-1\\))을 유의하자.\n\n6.4.1 최소제곱평균과 각 평균의 비교\n공분산 분석 모형 6.1 에서 각 처리에 대한 평균을 구할 때 공변량의 값에 따라서 그 값이 변한다. 따라서 각 그룹의 평균을 비교하는 경우에는 모형의 공변량에 공변량의 전체 평균을 넣어 사용한다. 이러한 평균을 보정된 최소제곱평균(Least Square Mean)이라고 한다\n\\[ \\bar y_i = \\hat \\mu + \\hat \\alpha_i + \\hat \\beta \\bar x_{..} \\]\n또한 그룹의 평균들을 각각 비교할 수 있다.\n\\[ H_0: \\alpha_i =\\alpha_j \\quad \\text{ vs. } \\quad  H_1:\\alpha_i  \\ne \\alpha_j  \\]",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>공분산분석</span>"
    ]
  },
  {
    "objectID": "notes/ancova.html#예제-저혈당-실험",
    "href": "notes/ancova.html#예제-저혈당-실험",
    "title": "6  공분산분석",
    "section": "6.5 예제: 저혈당 실험",
    "text": "6.5 예제: 저혈당 실험\n앞에서 살펴본 예제 @ref(diabetes) 의 저혈당 임상실험에서는 혈당을 감소시키기 위한 다섯 개의 처리(treat)를 비교 하려고 한다. 반응 변수 response 는 치료 적용 1달 후 혈당량 수치이며 각 처리그룹에 대한 자료와 상자그림은 다음과 같다.\n\ndiabetes &lt;- read.csv(here(\"data\", \"chapter-5-data.txt\"), sep='', header = F)\n\ndiabetes &lt;- read.csv(here(\"data\", \"chapter-5-data.txt\"), sep='', header = F)\ncolnames(diabetes) &lt;- c(\"treat\", \"baseline\", \"response\")\ndiabetes$treat&lt;- factor(diabetes$treat)\ndiabetes &lt;- diabetes %&gt;% arrange(treat)\n\ndfsumm &lt;- diabetes %&gt;% group_by(treat)  %&gt;%  summarise(mean=mean(response), median= median(response), sd=sd(response), min=min(response), max=max(response))\n\nggplot(diabetes, aes(treat, response)) +\n  geom_boxplot() + \n  geom_line(data=dfsumm, aes(x=treat, y=mean, group=1), linewidth=1.5, col=\"#9ACBF9\") +\n  geom_point(data=dfsumm, aes(x=treat, y=mean), col=\"darkblue\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n대부분의 임상실험에서는 치료를 시작하기 전에 반응변수의 값을 먼저 측정하고 치료 후의 변화를 본다. 치료를 시작하기 전에 반응변수의 값을 기준값(baseline value) 라고 한다. 기준값은 환자의 치료 전 상태를 나타내는 중요한 변수이며 반응값에 영향을 미칠 수 있으므로 대부분의 임상실험에서는 기준값을 공변량으로 분석에 포함한다. 저혈당 실험의 공변량 \\(x\\) 는 치료 전 측정한 혈당량 수치(baseline)이다.\n이러한 기준값의 분포가 각 처리집단 별로 크게 다르면 실험의 공정성에 문제가 생긴다.\n이제 치료 전 측정한 혈당량의 분포를 처리 집단별로 살펴보자. 아래 그림에서 보면 치료잡단별로 치료 전 측정한 혈당량의 분포가 다르다는 것을 알 수 있다.\n\nggplot(diabetes, aes(treat, baseline)) + \n  geom_boxplot() + \n  theme_bw()\n\n\n\n\n\n\n\n\n이제 치료 전 측정한 혈당량과 치료 후의 혈당량의 관계는 다음과 같은 산점도로 나타낼 수 있으며 강한 양의 선형관계가 있다는 것을 알 수 있다.즉 초기 형당량 수치가 크면 1달 후 혈당량 수치도 평균적으로 크다.\n\nggplot(diabetes, aes(baseline, response))+geom_point(aes(colour = treat))\n\n\n\n\n\n\n\n\n\nggplot(diabetes, aes(baseline, response))+geom_point(aes(colour = treat)) + \n  facet_wrap(\"treat\")\n\n\n\n\n\n\n\n\n이제 공변량을 사용하지 않는 분산분석 모형을 적합해 보자. 처리 간에 산소운반 능력이 유의한 차이가 없다.\n\ndiab1 &lt;- lm(response~treat, data=diabetes )\nsummary(diab1)\n\n\nCall:\nlm(formula = response ~ treat, data = diabetes)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-5.225 -1.781 -0.800  2.306  5.275 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   34.475      1.634  21.094 1.46e-12 ***\ntreat2        -2.825      2.311  -1.222 0.240469    \ntreat3        -3.625      2.311  -1.568 0.137642    \ntreat4        -2.250      2.311  -0.973 0.345753    \ntreat5        -9.450      2.311  -4.089 0.000968 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.269 on 15 degrees of freedom\nMultiple R-squared:  0.5532,    Adjusted R-squared:  0.434 \nF-statistic: 4.643 on 4 and 15 DF,  p-value: 0.01224\n\nanova(diab1)\n\nAnalysis of Variance Table\n\nResponse: response\n          Df Sum Sq Mean Sq F value  Pr(&gt;F)  \ntreat      4 198.41  49.602  4.6425 0.01224 *\nResiduals 15 160.26  10.684                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n다음으로 치료 전의 혈당을 공변량으로 포함한 공분석 결과를 적합해 보자.\n\n\n\n\n\n\n주의\n\n\n\n우리가 지금까지 사용한 anova() 함수를 이용하면 소위 Type I 제곱합(type I sum of squares)을 이용한 분산분석을 제공한다.\n모형이 두 개 이상의 요인을 가지는 경우에 분산분석을 적용하는 경우 anova() 함수의 Type I 제곱합은 고려하는 요인의 순서에 따라서 제곱합의 값이 달라지기 때문에 우리가 원하는 검정을 실시할 수 없다.\n모형이 두 개 이상의 요인을 가지는 경우는 패키지 car 의 Anova() 함수를 이용해야 하며, 선택문으로 type=\"III\" 를 사용해야 한다. 이렇게 선택문 type=\"III\" 으로 Anova() 함수를 이용해야만 요인의 순서에 관계없이 각 요인의 순수 효과만을 이용하여 가설 검정을 할 수 있다.\n요인이 하나인 경우는 요인의 순서에 상관이 없으므로 anova() 함수를 사용해도 무방하다.\n\n\n\ndiab2 &lt;- lm(response~ baseline + treat, data=diabetes )\nsummary(diab2)\n\n\nCall:\nlm(formula = response ~ baseline + treat, data = diabetes)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.1360 -1.0024 -0.2827  0.7257  6.0806 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)  13.9437     4.8219   2.892 0.011834 *  \nbaseline      0.7534     0.1723   4.373 0.000637 ***\ntreat2       -2.7685     1.5554  -1.780 0.096793 .  \ntreat3       -1.6660     1.6186  -1.029 0.320776    \ntreat4       -1.6284     1.5618  -1.043 0.314787    \ntreat5       -4.5903     1.9115  -2.401 0.030788 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.2 on 14 degrees of freedom\nMultiple R-squared:  0.8112,    Adjusted R-squared:  0.7437 \nF-statistic: 12.03 on 5 and 14 DF,  p-value: 0.0001164\n\nAnova(diab2, type=\"III\")\n\nAnova Table (Type III tests)\n\nResponse: response\n            Sum Sq Df F value    Pr(&gt;F)    \n(Intercept) 40.457  1  8.3621 0.0118339 *  \nbaseline    92.528  1 19.1248 0.0006369 ***\ntreat       34.188  4  1.7666 0.1916720    \nResiduals   67.734 14                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n분산분석 모형에서는 평균 잔차제곱합이 \\(MSE=10.684\\) 이지만 공분산분석에서는 \\(MSE=67.734 / 14 = 4.838\\) 로 감소하였다.\n하지만 치료약의 효과를 보면 공분산분석에서는 유의하지 않게 나타났다. 이는 공변량인 치료 전의 혈당이 치료 후의 혈당을 설명하는데 매우 유의한 요인이기 떄문이다. 즉 치료 후의 혈당의 집단별 변동이 큰 이유는 치료 효과때문이 아니라 치료 전의 혈당의 차이 때문으로 보여진다.\n이러한 결과의 교훈은 여러 개의 집단을 비교하는 경우, 처리를 배정할 때 임의화 방법(randomization)을 사용하여 실험 전 환자들의 인구적 특성과 증상의 정도가 처리그룹간에 큰 차이가 없이 만들어야 한다. 우리가 살펴본 저혈당 임상실험은 처리를 비교하기 위한 공정한 실험이라고 보기 힘들다.\n마지막으로 분석에 사용하는 반응변수를 치료 후 반응값이 아닌 기준값에서의 변화량(change from baseline) 으로 사용할 수 있다.\n이제 다음과 치료 전과 후의 변화량을 반응변수로 하고 공분산분석을 적용해보자.\n\ndiabetes2 &lt;- diabetes %&gt;% dplyr::mutate(diff = response - baseline)\nggplot(diabetes2, aes(baseline, diff)) + \n  geom_point(aes(colour = treat))\n\n\n\n\n\n\n\n\n\ndiab3 &lt;- lm(diff~ baseline + treat, data=diabetes2 )\nsummary(diab3)\n\n\nCall:\nlm(formula = diff ~ baseline + treat, data = diabetes2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.1360 -1.0024 -0.2827  0.7257  6.0806 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)  \n(Intercept)  13.9437     4.8219   2.892   0.0118 *\nbaseline     -0.2466     0.1723  -1.431   0.1743  \ntreat2       -2.7685     1.5554  -1.780   0.0968 .\ntreat3       -1.6660     1.6186  -1.029   0.3208  \ntreat4       -1.6284     1.5618  -1.043   0.3148  \ntreat5       -4.5903     1.9115  -2.401   0.0308 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.2 on 14 degrees of freedom\nMultiple R-squared:  0.3387,    Adjusted R-squared:  0.1025 \nF-statistic: 1.434 on 5 and 14 DF,  p-value: 0.2723\n\nAnova(diab3, type=\"III\")\n\nAnova Table (Type III tests)\n\nResponse: diff\n            Sum Sq Df F value  Pr(&gt;F)  \n(Intercept) 40.457  1  8.3621 0.01183 *\nbaseline     9.908  1  2.0480 0.17435  \ntreat       34.188  4  1.7666 0.19167  \nResiduals   67.734 14                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n위의 분석을 보면 변화량을 반응변수로 하면 기준값과 처리 모두 유의하지 않음을 알 수 있다.",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>공분산분석</span>"
    ]
  },
  {
    "objectID": "notes/ancova.html#예제-산소운반능력",
    "href": "notes/ancova.html#예제-산소운반능력",
    "title": "6  공분산분석",
    "section": "6.6 예제: 산소운반능력",
    "text": "6.6 예제: 산소운반능력\n부교재 Jaewon Lee (2005) 의 5장에 나오는 산소운반 능력에 대한 실험 자료를 분석해 보자.\n흡연자를 대상으로 산소운반 능력을 개선하는 서로 다른 치료제의 효과를 비교하는 실험이다. 산소운반 능력에 영향을 미치는 중요한 변수로 1인당 담배소비량이 고려되어 이를 공변량으로 포함하여 공분산분석을 실시하려고 한다.\n다음과 같이 자료를 읽으며 변수의 설명은 다음과 같다.\n\ntreat : 치료법\ncigar : 1인당 담배 소비량\noxy : 산소운반능력\n\n\noxygen &lt;- read.csv(here(\"data\",\"chapter-5-data-2.txt\"), sep='', header = T)\noxygen$treat&lt;- factor(oxygen$treat)\noxygen &lt;- oxygen %&gt;% dplyr::rename(cigar = x, oxy = y)\n\n산소운반능력에 대한 임상실험에서 얻은 자료는 다음과 같다.\n\noxygen %&gt;%\n    kbl(caption = \"산소운반능력 임상실험 결과\") %&gt;%\n    kable_styling(bootstrap_options = \"striped\", full_width = F, position = \"center\",\n        font_size = 12)\n\n\n산소운반능력 임상실험 결과\n\n\ntreat\ncigar\noxy\n\n\n\n\n1\n40\n165\n\n\n1\n54\n85\n\n\n1\n85\n9\n\n\n1\n95\n43\n\n\n1\n81\n94\n\n\n1\n26\n226\n\n\n1\n90\n7\n\n\n1\n95\n9\n\n\n1\n83\n12\n\n\n1\n83\n145\n\n\n2\n85\n11\n\n\n2\n83\n6\n\n\n2\n65\n51\n\n\n2\n98\n18\n\n\n2\n47\n189\n\n\n2\n74\n90\n\n\n2\n75\n10\n\n\n2\n97\n12\n\n\n2\n79\n35\n\n\n2\n91\n27\n\n\n3\n65\n89\n\n\n3\n25\n64\n\n\n3\n34\n87\n\n\n3\n20\n45\n\n\n3\n30\n56\n\n\n3\n29\n87\n\n\n3\n100\n59\n\n\n3\n85\n39\n\n\n3\n24\n87\n\n\n3\n26\n67\n\n\n\n\n\n\n\n치료집단 별로 치료 후 산소운반능력의 분포를 다음과 상자그림으로 비교해보자.\n\ndfsumm2 &lt;- oxygen %&gt;%\n    group_by(treat) %&gt;%\n    summarise(mean = mean(oxy), median = median(oxy), sd = sd(oxy), min = min(oxy),\n        max = max(oxy))\ndfsumm2\n\n# A tibble: 3 × 6\n  treat  mean median    sd   min   max\n  &lt;fct&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;\n1 1      79.5   64    77.7     7   226\n2 2      44.9   22.5  56.7     6   189\n3 3      68     65.5  18.7    39    89\n\n\n\nggplot(oxygen, aes(treat, oxy)) +\n  geom_boxplot() + \n  geom_line(data=dfsumm2, aes(x=treat, y=mean, group=1), linewidth=1.5, col=\"#9ACBF9\") +\n  geom_point(data=dfsumm2, aes(x=treat, y=mean), col=\"darkblue\") +\n  theme_bw()\n\n\n\n\n\n\n\n\n이제 1인당 담배소비량과 산소운반 능력의 관계는 다음과 같은 산점도로 나타낼 수 있다.\n\nggplot(oxygen, aes(cigar, oxy))+\n  geom_point(aes(colour = treat))\n\n\n\n\n\n\n\n\n1인당 담배소비량과 산소운반 능력의 관계를 상관계수로 구해보면 음의 상관관계를 보이고 있으면 1인당 담배소비량이 증가하면 산소운반 능력이 감소하는 것을 알 수 있다.\n\ncor(oxygen$cigar, oxygen$oxy)\n\n[1] -0.5349395\n\n\n이제 조금 더 자세하고 처리 그룹별로 산소운반 능력과 1인당 담배소비량의 관계를 살펴보자. 아래 그름을 보면 산소운반 능력과 1인당 담배소비량의 관계가 처리 그룹별로 다르게 나타나는 것을 알 수 있다. 처리 그룹 1 과 2에서는 1인당 담배소비량이 증가하면 산소운반 능력이 감소하는 것을 알 수 있지만 처리 그룹 3에서는 그렇지 않다.\n\nggplot(oxygen, aes(cigar, oxy)) + \n  geom_point(aes(colour = treat)) + \n  facet_wrap(\"treat\")\n\n\n\n\n\n\n\n\n이제 공변량을 사용하지 않는 분산분석 모형을 적합해 보자. 다음 결과를 보면 처리 간에 산소운반 능력이 유의한 차이가 없다.\n\noxy1 &lt;- lm(oxy~treat, data=oxygen )\nanova(oxy1)\n\nAnalysis of Variance Table\n\nResponse: oxy\n          Df Sum Sq Mean Sq F value Pr(&gt;F)\ntreat      2   6210  3105.0  0.9696 0.3921\nResiduals 27  86465  3202.4               \n\n\n다음으로 1인당 담배소비량을 공변량으로 포함한 공분석 결과를 적합해 보자.\n\noxy2 &lt;- lm(oxy ~ cigar + treat, data=oxygen )\nsummary(oxy2)\n\n\nCall:\nlm(formula = oxy ~ cigar + treat, data = oxygen)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-57.974 -32.116  -8.566  30.148  96.489 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) 187.0662    30.9742   6.039 2.22e-06 ***\ncigar        -1.4695     0.3743  -3.926 0.000567 ***\ntreat2      -25.4892    20.5656  -1.239 0.226266    \ntreat3      -54.7028    23.2087  -2.357 0.026234 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 45.69 on 26 degrees of freedom\nMultiple R-squared:  0.4143,    Adjusted R-squared:  0.3467 \nF-statistic:  6.13 on 3 and 26 DF,  p-value: 0.002697\n\nAnova(oxy2, type=\"III\")\n\nAnova Table (Type III tests)\n\nResponse: oxy\n            Sum Sq Df F value    Pr(&gt;F)    \n(Intercept)  76152  1 36.4746 2.224e-06 ***\ncigar        32183  1 15.4146 0.0005667 ***\ntreat        11873  2  2.8433 0.0764293 .  \nResiduals    54283 26                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n위에서 공변량을 포함한 공분산분석 결과를 보면 담배소비량이 산소운반 능력을 설명하는 유의한 변수이며 음의 기울기를 나타내는 것을 알 수 있다.\n처리 간에 산소운반 능력이 유의 수준 5% 로는 유의한 차이가 없다고 나타났지만 공변량이 없는 위의 모형보다 p-값이 크게 감소한것을 알 수 있다 .\n유의할 점은 공변량이 없는 경우 모분산의 추정값인 평균 잔차제곱합이 \\(MSE=3202.4\\) 로 추정되고 공변량이 포함되면 \\(MSE = 54283/26 = 2087.8\\) 이다. 이는 1인당 담배소비량이 산소운반 능력을 설명하는 유의한 변수이기 떄문이다. 따라서 공변량이 포함된 모형에서 처리에 대한 \\(F\\)-검정통계량의 값이 커지는 결과가 나타난다.\n이렇게 반응변수를 설명하는데 있어서 유의한 공변량을 포함시키면 일반적으로 처리에 대한 검정력이 높아진다.\n1인당 담배소비량과 산소운반 능력의 관계가 각 그룹마다 차이가 있다면 공변량의 효과가 처리집단에 따라서 달라지는 다음 모형을 고려해 보자. 다음 모형에서 공변량에 대한 회귀 계수의 값이 처리집단마다 다른 것(\\(\\beta_1, \\beta_2,\\beta_3\\))을 알 수 있다.\n\\[\ny_{ij} = \\mu + \\alpha_i + \\beta_i ~ x_{ij}  + e_{ij},\n\\quad i=1,2,\\dots,a, ~~ j=1,2,\\dots,r\n\\tag{6.4}\\]\n이제 식 6.4 를 이용하여 공분산 분석을 실행해 보자.\n공변량의 효과가 처리 집단마다 다르게 놓은 모형 6.4 에서는 처리집단 간의 유의한 차이가 나타난다 (p-값 = 8.272e-05). 평균 잔차제곱합도 \\(MSE = 29146/24= 1214.4\\) 으로 줄어든 것을 알 수 있다.\n\noxy3 &lt;- lm(oxy ~ cigar + treat*cigar, data=oxygen )\nsummary(oxy3)\n\n\nCall:\nlm(formula = oxy ~ cigar + treat * cigar, data = oxygen)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-48.179 -25.812  -3.413  20.850  91.544 \n\nCoefficients:\n              Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   274.0363    36.6575   7.476 1.03e-07 ***\ncigar          -2.6576     0.4776  -5.564 1.00e-05 ***\ntreat2         10.4882    71.0085   0.148 0.883811    \ntreat3       -198.4239    42.1708  -4.705 8.79e-05 ***\ncigar:treat2   -0.3603     0.8919  -0.404 0.689783    \ncigar:treat3    2.4838     0.6256   3.970 0.000568 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 34.85 on 24 degrees of freedom\nMultiple R-squared:  0.6855,    Adjusted R-squared:   0.62 \nF-statistic: 10.46 on 5 and 24 DF,  p-value: 2.031e-05\n\nAnova(oxy3, type=\"III\")\n\nAnova Table (Type III tests)\n\nResponse: oxy\n            Sum Sq Df F value    Pr(&gt;F)    \n(Intercept)  67868  1  55.884 1.026e-07 ***\ncigar        37600  1  30.961 1.004e-05 ***\ntreat        34648  2  14.265 8.272e-05 ***\ncigar:treat  25137  2  10.349 0.0005742 ***\nResiduals    29146 24                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\n\nJaewon Lee, Hanna Yu, Mira Park. 2005. 생명과학연구를 위한 통계적 방법. 1st ed. 자유아카데미.",
    "crumbs": [
      "집단의 비교",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>공분산분석</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Agresti, Alan. 2003. Categorical Data Analysis. Vol. 482. John\nWiley & Sons.\n\n\n———. 2012. Categorical Data Analysis. Vol. 792. John Wiley\n& Sons.\n\n\nButler-Laporte, Guillaume, Alexander Lawandi, Ian Schiller, Mandy Yao,\nNandini Dendukuri, Emily G McDonald, and Todd C Lee. 2021.\n“Comparison of Saliva and Nasopharyngeal Swab Nucleic Acid\nAmplification Testing for Detection of SARS-CoV-2: A Systematic Review\nand Meta-Analysis.” JAMA Intern Med 181 (3): 353–58.\n\n\nJaewon Lee, Hanna Yu, Mira Park. 2005. 생명과학연구를 위한 통계적\n방법. 1st ed. 자유아카데미.",
    "crumbs": [
      "References"
    ]
  }
]